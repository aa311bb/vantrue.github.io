import{a0 as Xt,d as $t,r as Te,Q as qt,c as Zt,x as it,a1 as Qt,E as It,a as Jt,b as fe,B as ei,e as nt,a2 as Qe,a3 as ti,_ as ii,a4 as ni,o as ri,f as si}from"./index-De6GvLOu.js";import{u as ai}from"./use-expose-Oe1mBPbS.js";import{L as oi}from"./index-DpB2-7h_.js";import{c as ui,a as li,m as ci,t as fi,k as hi,w as di}from"./index-CRmXhf89.js";const gi=Symbol(),vi=()=>Xt(gi,null),[pi,he,mi]=ui("list"),yi={error:Boolean,offset:li(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:ci("down"),loadingText:String,finishedText:String,immediateCheck:fi};var _i=$t({name:pi,props:yi,emits:["load","update:error","update:loading"],setup(a,{emit:s,slots:r}){const t=Te(a.loading),e=Te(),i=Te(),n=vi(),o=qt(e),u=Zt(()=>a.scroller||o.value),l=()=>{ei(()=>{if(t.value||a.finished||a.disabled||a.error||(n==null?void 0:n.value)===!1)return;const{direction:g}=a,m=+a.offset,p=nt(u);if(!p.height||hi(e))return;let T=!1;const E=nt(i);g==="up"?T=p.top-E.top<=m:T=E.bottom-p.bottom<=m,T&&(t.value=!0,s("update:loading",!0),s("load"))})},f=()=>{if(a.finished){const g=r.finished?r.finished():a.finishedText;if(g)return fe("div",{class:he("finished-text")},[g])}},h=()=>{s("update:error",!1),l()},d=()=>{if(a.error){const g=r.error?r.error():a.errorText;if(g)return fe("div",{role:"button",class:he("error-text"),tabindex:0,onClick:h},[g])}},v=()=>{if(t.value&&!a.finished&&!a.disabled)return fe("div",{class:he("loading")},[r.loading?r.loading():fe(oi,{class:he("loading-icon")},{default:()=>[a.loadingText||mi("loading")]})])};return it(()=>[a.loading,a.finished,a.error],l),n&&it(n,g=>{g&&l()}),Qt(()=>{t.value=a.loading}),It(()=>{a.immediateCheck&&l()}),ai({check:l}),Jt("scroll",l,{target:u,passive:!0}),()=>{var g;const m=(g=r.default)==null?void 0:g.call(r),p=fe("div",{ref:i,class:he("placeholder")},null);return fe("div",{ref:e,role:"feed",class:he(),"aria-busy":t.value},[a.direction==="down"?m:p,v(),f(),d(),a.direction==="up"?m:p])}}});const Ar=di(_i);function rt(a,s){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);s&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),r.push.apply(r,t)}return r}function W(a){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?rt(Object(r),!0).forEach(function(t){k(a,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):rt(Object(r)).forEach(function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(r,t))})}return a}function Y(a){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Y(a)}function w(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}function st(a,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,At(t.key),t)}}function x(a,s,r){return s&&st(a.prototype,s),r&&st(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}function k(a,s,r){return s=At(s),s in a?Object.defineProperty(a,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[s]=r,a}function R(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),s&&Ye(a,s)}function b(a){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},b(a)}function Ye(a,s){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ye(a,s)}function Ci(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Pt(a,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _(a)}function D(a){var s=Ci();return function(){var t=b(a),e;if(s){var i=b(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return Pt(this,e)}}function Ei(a,s){for(;!Object.prototype.hasOwnProperty.call(a,s)&&(a=b(a),a!==null););return a}function S(){return typeof Reflect<"u"&&Reflect.get?S=Reflect.get.bind():S=function(s,r,t){var e=Ei(s,r);if(e){var i=Object.getOwnPropertyDescriptor(e,r);return i.get?i.get.call(arguments.length<3?s:t):i.value}},S.apply(this,arguments)}function J(a){return ki(a)||Ti(a)||bi(a)||Si()}function ki(a){if(Array.isArray(a))return Ke(a)}function Ti(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function bi(a,s){if(a){if(typeof a=="string")return Ke(a,s);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ke(a,s)}}function Ke(a,s){(s==null||s>a.length)&&(s=a.length);for(var r=0,t=new Array(s);r<s;r++)t[r]=a[r];return t}function Si(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wi(a,s){if(typeof a!="object"||a===null)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var t=r.call(a,s||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function At(a){var s=wi(a,"string");return typeof s=="symbol"?s:String(s)}var Lt={exports:{}};(function(a){var s=Object.prototype.hasOwnProperty,r="~";function t(){}Object.create&&(t.prototype=Object.create(null),new t().__proto__||(r=!1));function e(u,l,f){this.fn=u,this.context=l,this.once=f||!1}function i(u,l,f,h,d){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new e(f,h||u,d),g=r?r+l:l;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],v]:u._events[g].push(v):(u._events[g]=v,u._eventsCount++),u}function n(u,l){--u._eventsCount===0?u._events=new t:delete u._events[l]}function o(){this._events=new t,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],f,h;if(this._eventsCount===0)return l;for(h in f=this._events)s.call(f,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},o.prototype.listeners=function(l){var f=r?r+l:l,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,v=h.length,g=new Array(v);d<v;d++)g[d]=h[d].fn;return g},o.prototype.listenerCount=function(l){var f=r?r+l:l,h=this._events[f];return h?h.fn?1:h.length:0},o.prototype.emit=function(l,f,h,d,v,g){var m=r?r+l:l;if(!this._events[m])return!1;var p=this._events[m],T=arguments.length,E,C;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),T){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,f),!0;case 3:return p.fn.call(p.context,f,h),!0;case 4:return p.fn.call(p.context,f,h,d),!0;case 5:return p.fn.call(p.context,f,h,d,v),!0;case 6:return p.fn.call(p.context,f,h,d,v,g),!0}for(C=1,E=new Array(T-1);C<T;C++)E[C-1]=arguments[C];p.fn.apply(p.context,E)}else{var N=p.length,P;for(C=0;C<N;C++)switch(p[C].once&&this.removeListener(l,p[C].fn,void 0,!0),T){case 1:p[C].fn.call(p[C].context);break;case 2:p[C].fn.call(p[C].context,f);break;case 3:p[C].fn.call(p[C].context,f,h);break;case 4:p[C].fn.call(p[C].context,f,h,d);break;default:if(!E)for(P=1,E=new Array(T-1);P<T;P++)E[P-1]=arguments[P];p[C].fn.apply(p[C].context,E)}}return!0},o.prototype.on=function(l,f,h){return i(this,l,f,h,!1)},o.prototype.once=function(l,f,h){return i(this,l,f,h,!0)},o.prototype.removeListener=function(l,f,h,d){var v=r?r+l:l;if(!this._events[v])return this;if(!f)return n(this,v),this;var g=this._events[v];if(g.fn)g.fn===f&&(!d||g.once)&&(!h||g.context===h)&&n(this,v);else{for(var m=0,p=[],T=g.length;m<T;m++)(g[m].fn!==f||d&&!g[m].once||h&&g[m].context!==h)&&p.push(g[m]);p.length?this._events[v]=p.length===1?p[0]:p:n(this,v)}return this},o.prototype.removeAllListeners=function(l){var f;return l?(f=r?r+l:l,this._events[f]&&n(this,f)):(this._events=new t,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,a.exports=o})(Lt);var Ot=Lt.exports;const xi=Qe(Ot);var Ii=typeof window<"u"&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,Me={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},He="%c[xgplayer]",L={config:{debug:Ii?3:0},logInfo:function(s){for(var r,t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];this.config.debug>=3&&(r=console).log.apply(r,[He,Me.info,s].concat(e))},logWarn:function(s){for(var r,t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];this.config.debug>=1&&(r=console).warn.apply(r,[He,Me.warn,s].concat(e))},logError:function(s){var r;if(!(this.config.debug<1)){for(var t=this.config.debug>=2?"trace":"error",e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];(r=console)[t].apply(r,[He,Me.error,s].concat(i))}}};function Pi(a){a.logInfo=L.logInfo.bind(a),a.logWarn=L.logWarn.bind(a),a.logError=L.logError.bind(a)}var Ai=function(){function a(s){w(this,a),this.bufferedList=s}return x(a,[{key:"start",value:function(r){return this.bufferedList[r].start}},{key:"end",value:function(r){return this.bufferedList[r].end}},{key:"length",get:function(){return this.bufferedList.length}}]),a}(),c={};c.createDom=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",e=document.createElement(a);return e.className=t,e.innerHTML=s,Object.keys(r).forEach(function(i){var n=i,o=r[i];a==="video"||a==="audio"||a==="live-video"?o&&e.setAttribute(n,o):e.setAttribute(n,o)}),e};c.createDomFromHtml=function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";try{var t=document.createElement("div");t.innerHTML=a;var e=t.children;return t=null,e.length>0?(e=e[0],r&&c.addClass(e,r),s&&Object.keys(s).forEach(function(i){e.setAttribute(i,s[i])}),e):null}catch(i){return L.logError("util.createDomFromHtml",i),null}};c.hasClass=function(a,s){if(!a||!s)return!1;try{return Array.prototype.some.call(a.classList,function(t){return t===s})}catch{var r=a.className&&Y(a.className)==="object"?a.getAttribute("class"):a.className;return r&&!!r.match(new RegExp("(\\s|^)"+s+"(\\s|$)"))}};c.addClass=function(a,s){if(!(!a||!s))try{s.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(r){r&&a.classList.add(r)})}catch{c.hasClass(a,s)||(a.className&&Y(a.className)==="object"?a.setAttribute("class",a.getAttribute("class")+" "+s):a.className+=" "+s)}};c.removeClass=function(a,s){if(!(!a||!s))try{s.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(r){r&&a.classList.remove(r)})}catch{c.hasClass(a,s)&&s.split(/\s+/g).forEach(function(t){var e=new RegExp("(\\s|^)"+t+"(\\s|$)");a.className&&Y(a.className)==="object"?a.setAttribute("class",a.getAttribute("class").replace(e," ")):a.className=a.className.replace(e," ")})}};c.toggleClass=function(a,s){a&&s.split(/\s+/g).forEach(function(r){c.hasClass(a,r)?c.removeClass(a,r):c.addClass(a,r)})};c.classNames=function(){for(var a=arguments,s=[],r=function(i){c.typeOf(a[i])==="String"?s.push(a[i]):c.typeOf(a[i])==="Object"&&Object.keys(a[i]).map(function(n){a[i][n]&&s.push(n)})},t=0;t<arguments.length;t++)r(t);return s.join(" ")};c.findDom=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,s=arguments.length>1?arguments[1]:void 0,r;try{r=a.querySelector(s)}catch(t){L.logError("util.findDom",t),s.indexOf("#")===0&&(r=a.getElementById(s.slice(1)))}return r};c.getCss=function(a,s){return a.currentStyle?a.currentStyle[s]:document.defaultView.getComputedStyle(a,!1)[s]};c.padStart=function(a,s,r){for(var t=String(r),e=s>>0,i=Math.ceil(e/t.length),n=[],o=String(a);i--;)n.push(t);return n.join("").substring(0,e-o.length)+o};c.format=function(a){if(window.isNaN(a))return"";a=Math.round(a);var s=c.padStart(Math.floor(a/3600),2,0),r=c.padStart(Math.floor((a-s*3600)/60),2,0),t=c.padStart(Math.floor(a-s*3600-r*60),2,0);return(s==="00"?[r,t]:[s,r,t]).join(":")};c.event=function(a){if(a.touches){var s=a.touches[0]||a.changedTouches[0];a.clientX=s.clientX||0,a.clientY=s.clientY||0,a.offsetX=s.pageX-s.target.offsetLeft,a.offsetY=s.pageY-s.target.offsetTop}a._target=a.target||a.srcElement};c.typeOf=function(a){return Object.prototype.toString.call(a).match(/([^\s.*]+)(?=]$)/g)[0]};c.deepCopy=function(a,s){if(c.typeOf(s)==="Object"&&c.typeOf(a)==="Object")return Object.keys(s).forEach(function(r){c.typeOf(s[r])==="Object"&&!(s[r]instanceof Node)?a[r]===void 0||a[r]===void 0?a[r]=s[r]:c.deepCopy(a[r],s[r]):c.typeOf(s[r])==="Array"?a[r]=c.typeOf(a[r])==="Array"?a[r].concat(s[r]):s[r]:a[r]=s[r]}),a};c.deepMerge=function(a,s){return Object.keys(s).map(function(r){if(c.typeOf(s[r])==="Array"&&c.typeOf(a[r])==="Array"){if(c.typeOf(a[r])==="Array"){var t;(t=a[r]).push.apply(t,J(s[r]))}}else c.typeOf(a[r])===c.typeOf(s[r])&&a[r]!==null&&c.typeOf(a[r])==="Object"&&!(s[r]instanceof window.Node)?c.deepMerge(a[r],s[r]):s[r]!==null&&(a[r]=s[r])}),a};c.getBgImage=function(a){var s=(a.currentStyle||window.getComputedStyle(a,null)).backgroundImage;if(!s||s==="none")return"";var r=document.createElement("a");return r.href=s.replace(/url\("|"\)/g,""),r.href};c.copyDom=function(a){if(a&&a.nodeType===1){var s=document.createElement(a.tagName);return Array.prototype.forEach.call(a.attributes,function(r){s.setAttribute(r.name,r.value)}),a.innerHTML&&(s.innerHTML=a.innerHTML),s}else return""};c.setInterval=function(a,s,r,t){a._interval[s]||(a._interval[s]=window.setInterval(r.bind(a),t))};c.clearInterval=function(a,s){clearInterval(a._interval[s]),a._interval[s]=null};c.setTimeout=function(a,s,r){a._timers||(a._timers=[]);var t=setTimeout(function(){s(),c.clearTimeout(a,t)},r);return a._timers.push(t),t};c.clearTimeout=function(a,s){var r=a._timers;if(c.typeOf(r)==="Array"){for(var t=0;t<r.length;t++)if(r[t]===s){r.splice(t,1),clearTimeout(s);break}}else clearTimeout(s)};c.clearAllTimers=function(a){var s=a._timers;c.typeOf(s)==="Array"&&(s.map(function(r){clearTimeout(r)}),a._timerIds=[])};c.createImgBtn=function(a,s,r,t){var e=c.createDom("xg-".concat(a),"",{},"xgplayer-".concat(a,"-img"));if(e.style.backgroundImage='url("'.concat(s,'")'),r&&t){var i,n,o;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(u){return r.indexOf(u)>-1&&t.indexOf(u)>-1?(i=parseFloat(r.slice(0,r.indexOf(u)).trim()),n=parseFloat(t.slice(0,t.indexOf(u)).trim()),o=u,!1):!0}),e.style.width="".concat(i).concat(o),e.style.height="".concat(n).concat(o),e.style.backgroundSize="".concat(i).concat(o," ").concat(n).concat(o),a==="start"?e.style.margin="-".concat(n/2).concat(o," auto auto -").concat(i/2).concat(o):e.style.margin="auto 5px auto 5px"}return e};c.Hex2RGBA=function(a,s){var r=[];if(/^\#[0-9A-F]{3}$/i.test(a)){var t="#";a.replace(/[0-9A-F]/ig,function(e){t+=e+e}),a=t}return/^#[0-9A-F]{6}$/i.test(a)?(a.replace(/[0-9A-F]{2}/ig,function(e){r.push(parseInt(e,16))}),"rgba(".concat(r.join(","),", ").concat(s,")")):"rgba(255, 255, 255, 0.1)"};c.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};c.checkIsFunction=function(a){return a&&typeof a=="function"};c.checkIsObject=function(a){return a!==null&&Y(a)==="object"};c.hide=function(a){a.style.display="none"};c.show=function(a,s){a.style.display=s||"block"};c.isUndefined=function(a){if(typeof a>"u"||a===null)return!0};c.isNotNull=function(a){return a!=null};c.setStyleFromCsstext=function(a,s){if(s)if(c.typeOf(s)==="String"){var r=s.replace(/\s+/g,"").split(";");r.map(function(t){if(t){var e=t.split(":");e.length>1&&(a.style[e[0]]=e[1])}})}else Object.keys(s).map(function(t){a.style[t]=s[t]})};function Li(a,s){for(var r=0,t=s.length;r<t;r++)if(a.indexOf(s[r])>-1)return!0;return!1}c.filterStyleFromText=function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],r=a.style.cssText;if(!r)return{};var t=r.replace(/\s+/g,"").split(";"),e={},i={};return t.map(function(n){if(n){var o=n.split(":");o.length>1&&(Li(o[0],s)?e[o[0]]=o[1]:i[o[0]]=o[1])}}),a.setAttribute("style",""),Object.keys(i).map(function(n){a.style[n]=i[n]}),e};c.getStyleFromCsstext=function(a){var s=a.style.cssText;if(!s)return{};var r=s.replace(/\s+/g,"").split(";"),t={};return r.map(function(e){if(e){var i=e.split(":");i.length>1&&(t[i[0]]=i[1])}}),t};c.preloadImg=function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(a){var t=new window.Image;t.onload=function(e){t=null,s&&s(e)},t.onerror=function(e){t=null,r&&r(e)},t.src=a}};c.stopPropagation=function(a){a&&a.stopPropagation()};c.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0};c.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0};c.checkTouchSupport=function(){return"ontouchstart"in window};c.getBuffered2=function(a){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,r=[],t=0;t<a.length;t++)r.push({start:a.start(t)<.5?0:a.start(t),end:a.end(t)});r.sort(function(u,l){var f=u.start-l.start;return f||l.end-u.end});var e=[];if(s)for(var i=0;i<r.length;i++){var n=e.length;if(n){var o=e[n-1].end;r[i].start-o<s?r[i].end>o&&(e[n-1].end=r[i].end):e.push(r[i])}else e.push(r[i])}else e=r;return new Ai(e)};c.getEventPos=function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return a.touches&&a.touches.length>0&&(a=a.touches[0]),{x:a.x/s,y:a.y/s,clientX:a.clientX/s,clientY:a.clientY/s,offsetX:a.offsetX/s,offsetY:a.offsetY/s,pageX:a.pageX/s,pageY:a.pageY/s}};c.requestAnimationFrame=function(a){var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(s)return s(a)};c.getHostFromUrl=function(a){if(c.typeOf(a)!=="String")return"";var s=a.split("/"),r="";return s.length>3&&s[2]&&(r=s[2]),r};c.cancelAnimationFrame=function(a){var s=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;s&&s(a)};c.isMSE=function(a){return a.media&&(a=a.media),!a||!(a instanceof HTMLMediaElement)?!1:/^blob/.test(a.currentSrc)||/^blob/.test(a.src)};c.isBlob=function(a){return typeof a=="string"&&/^blob/.test(a)};c.generateSessionId=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=new Date().getTime();try{a=parseInt(a)}catch{a=0}s+=a,window.performance&&typeof window.performance.now=="function"&&(s+=parseInt(window.performance.now()));var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(t==="x"?e:e&3|8).toString(16)});return r};c.createEvent=function(a){var s;return typeof window.Event=="function"?s=new Event(a):(s=document.createEvent("Event"),s.initEvent(a,!0,!0)),s};c.adjustTimeByDuration=function(a,s,r){return!s||!a?a:a>s||r&&a<s?s:a};c.createPositionBar=function(a,s){var r=c.createDom("xg-bar","",{"data-index":-1},a);return s.appendChild(r),r};c.getTransformStyle=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{x:0,y:0,scale:1,rotate:0},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r={scale:"".concat(a.scale||1),translate:"".concat(a.x||0,"%, ").concat(a.y||0,"%"),rotate:"".concat(a.rotate||0,"deg")},t=Object.keys(r);return t.forEach(function(e){var i=new RegExp("".concat(e,"\\([^\\(]+\\)"),"g"),n="".concat(e,"(").concat(r[e],")");i.test(s)?(i.lastIndex=-1,s=s.replace(i,n)):s+="".concat(n," ")}),s};c.convertDeg=function(a){return Math.abs(a)<=1?a*360:a%360};c.getIndexByTime=function(a,s){var r=s.length,t=-1;if(r<1)return t;if(a<=s[0].end||r<2)t=0;else if(a>s[r-1].end)t=r-1;else for(var e=1;e<r;e++)if(a>s[e-1].end&&a<=s[e].end){t=e;break}return t};c.getOffsetCurrentTime=function(a,s){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,t=-1;if(r>=0&&r<s.length?t=r:t=c.getIndexByTime(a,s),t<0)return-1;var e=s.length,i=s[t],n=i.start,o=i.end,u=i.cTime,l=i.offset;return a<n?u:a>=n&&a<=o?a-l:a>o&&t>=e-1?o:-1};c.getCurrentTimeByOffset=function(a,s){var r=-1;if(!s||s.length<0)return a;for(var t=0;t<s.length;t++)if(a<=s[t].duration){r=t;break}if(r!==-1){var e=s[r].start;return r-1<0?e+a:e+(a-s[r-1].duration)}return a};function Rt(a){var s=Y(a);return a!==null&&(s==="object"||s==="function")}function Oi(a,s,r){var t,e,i,n,o,u,l=0,f=!1,h=!1,d=!0,v=!s&&s!==0&&typeof window.requestAnimationFrame=="function";if(typeof a!="function")throw new TypeError("Expected a function");s=+s||0,Rt(r)&&(f=!!r.leading,h="maxWait"in r,i=h?Math.max(+r.maxWait||0,s):i,d="trailing"in r?!!r.trailing:d);function g(O){var K=t,$=e;return t=e=void 0,l=O,n=a.apply($,K),n}function m(O,K){return v?(window.cancelAnimationFrame(o),window.requestAnimationFrame(O)):setTimeout(O,K)}function p(O){if(v)return window.cancelAnimationFrame(O);clearTimeout(O)}function T(O){return l=O,o=m(N,s),f?g(O):n}function E(O){var K=O-u,$=O-l,q=s-K;return h?Math.min(q,i-$):q}function C(O){var K=O-u,$=O-l;return u===void 0||K>=s||K<0||h&&$>=i}function N(){var O=Date.now();if(C(O))return P(O);o=m(N,E(O))}function P(O){return o=void 0,d&&t?g(O):(t=e=void 0,n)}function F(){o!==void 0&&p(o),l=0,t=u=e=o=void 0}function I(){return o===void 0?n:P(Date.now())}function V(){return o!==void 0}function U(){for(var O=Date.now(),K=C(O),$=arguments.length,q=new Array($),ae=0;ae<$;ae++)q[ae]=arguments[ae];if(t=q,e=this,u=O,K){if(o===void 0)return T(u);if(h)return o=m(N,s),g(u)}return o===void 0&&(o=m(N,s)),n}return U.cancel=F,U.flush=I,U.pending=V,U}function Ri(a,s,r){var t=!0,e=!0;if(typeof a!="function")throw new TypeError("Expected a function");return Rt(r)&&(t="leading"in r?!!r.leading:t,e="trailing"in r?!!r.trailing:e),Oi(a,s,{leading:t,trailing:e,maxWait:s})}function Di(){var a=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase();return a==="zh-cn"&&(a="zh"),a}function Ni(a,s,r){if(a){var t=a.getAttribute(r);return!!(t&&t===s&&(a.tagName==="VIDEO"||a.tagName==="AUDIO"))}}var at={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},Fi=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],M={get device(){var a=M.os;return a.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var a=navigator.userAgent.toLowerCase(),s={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(s).filter(function(r){return s[r].test(a)}))[0]},get os(){if(typeof navigator>"u")return{};var a=navigator.userAgent,s=/(?:Windows Phone)/.test(a),r=/(?:SymbianOS)/.test(a)||s,t=/(?:Android)/.test(a),e=/(?:Firefox)/.test(a),i=/(?:iPad|PlayBook)/.test(a)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,n=i||t&&!/(?:Mobile)/.test(a)||e&&/(?:Tablet)/.test(a),o=/(?:iPhone)/.test(a)&&!n,u=!o&&!t&&!r&&!n;return{isTablet:n,isPhone:o,isIpad:i,isIos:o||i,isAndroid:t,isPc:u,isSymbian:r,isWindowsPhone:s,isFireFox:e}},get osVersion(){if(typeof navigator>"u")return 0;var a=navigator.userAgent,s="";/(?:iPhone)|(?:iPad|PlayBook)/.test(a)?s=at.ios:s=at.android;var r=s?s.exec(a):[];if(r&&r.length>=3){var t=r[2].split(".");return t.length>0?parseInt(t[0]):0}return 0},get isWeixin(){if(typeof navigator>"u")return!1;var a=/(micromessenger)\/([\d.]+)/,s=a.exec(navigator.userAgent.toLocaleLowerCase());return!!s},isSupportMP4:function(){var s={isSupport:!1,mime:""};if(typeof document>"u")return s;if(this.supportResult)return this.supportResult;var r=document.createElement("video");return typeof r.canPlayType=="function"&&Fi.map(function(t){r.canPlayType('video/mp4; codecs="'.concat(t,'"'))==="probably"&&(s.isSupport=!0,s.mime+="||".concat(t))}),this.supportResult=s,r=null,s},isMSESupport:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(typeof MediaSource>"u"||!MediaSource)return!1;try{return MediaSource.isTypeSupported(s)}catch(r){return this._logger.error(s,r),!1}},isHevcSupported:function(){return typeof MediaSource>"u"||!MediaSource.isTypeSupported?!1:MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"')},probeConfigSupported:function(s){var r={supported:!1,smooth:!1,powerEfficient:!1};if(!s||typeof navigator>"u")return Promise.resolve(r);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(s);var t=s.video||{},e=s.audio||{};try{var i=MediaSource.isTypeSupported(t.contentType),n=MediaSource.isTypeSupported(e.contentType);return Promise.resolve({supported:i&&n,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(r)}}},Xe="3.0.18",ot={1:"media",2:"media",3:"media",4:"media",5:"media",6:"media"},ut={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},$e=x(function a(s){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};w(this,a);var t=s&&s.i18n?s.i18n.ERROR_TYPES:null;if(s.media){var e=r.mediaError?r.mediaError:s.media.error||{},i=s.duration,n=s.currentTime,o=s.ended,u=s.src,l=s.currentSrc,f=s.media,h=f.readyState,d=f.networkState,v=r.errorCode||e.code;ut[v]&&(v=ut[v]);var g={playerVersion:Xe,currentTime:n,duration:i,ended:o,readyState:h,networkState:d,src:u||l,errorType:r.errorType,errorCode:v,message:r.errorMessage||e.message,mediaError:e,originError:r.originError?r.originError.stack:"",host:c.getHostFromUrl(u||l)};return r.ext&&Object.keys(r.ext).map(function(E){g[E]=r.ext[E]}),g}else if(arguments.length>1){for(var m={playerVersion:Xe,domain:document.domain},p=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],T=0;T<arguments.length;T++)m[p[T]]=arguments[T];return m.ex=t?(t[arguments[0]]||{}).msg:"",m}}),ye="play",Mi="playing",we="ended",Dt="pause",De="error",Hi="seeking",re="seeked",se="timeupdate",Nt="waiting",ce="canplay",Ne="durationchange",Bi="volumechange",Pe="loadeddata",Ui="ratechange",Gi="progress",ji="loadstart",Fe="emptied",Ft="focus",Wi="blur",Mt="ready",Vi="urlNull",me="autoplay_started",Ht="autoplay_was_prevented",Bt="complete",zi="replay",Ut="destroy",Je="urlchange",Yi="loading",ne="fullscreen_change",lt="cssFullscreen_change",Ki="mini_state_change",Gt="definition_change",ct="after_definition_change",_e="video_resize",ft="pip_change",Xi="rotate",$i="screenShot",qe="playnext",qi="xglog",ht="user_action",et="reset",Zi="source_error",Qi="source_success",Ji=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","loadedmetadata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode"];function Be(a,s){!this||!this.emit||(a==="error"?this.errorHandler(a,s.error):this.emit(a,s))}function en(a,s){return function(r,t){var e={player:s,eventName:a,originalEvent:r,detail:r.detail||{},timeStamp:r.timeStamp,currentTime:s.currentTime,duration:s.duration,paused:s.paused,ended:s.ended,isInternalOp:!!s._internalOp[r.type],muted:s.muted,volume:s.volume,host:c.getHostFromUrl(s.currentSrc),vtype:s.vtype};if(s.removeInnerOP(r.type),a==="timeupdate"&&(s._currentTime=s.media&&s.media.currentTime),a==="ratechange"){var i=s.media?s.media.playbackRate:0;if(i&&s._rate===i)return;s._rate=s.media&&s.media.playbackRate}if(a==="durationchange"&&(s._duration=s.media.duration),a==="volumechange"&&(e.isMutedChange=s._lastMuted!==s.muted,s._lastMuted=s.muted),a==="error"&&(e.error=t||s.video.error),s.mediaEventMiddleware[a]){var n=Be.bind(s,a,e);try{s.mediaEventMiddleware[a].call(s,e,n)}catch(o){throw Be.call(s,a,e),o}}else Be.call(s,a,e)}}var tn=function(a){R(r,a);var s=D(r);function r(t){var e;w(this,r),e=s.call(this,t),e._hasStart=!1,e._currentTime=0,e._duration=0,e._internalOp={},e._lastMuted=!1,e.vtype="MP4",e._rate=-1,e.mediaConfig=Object.assign({},{controls:!1,autoplay:t.autoplay,playsinline:t.playsinline,"x5-playsinline":t.playsinline,"webkit-playsinline":t.playsinline,"x5-video-player-fullscreen":t["x5-video-player-fullscreen"]||t.x5VideoPlayerFullscreen,"x5-video-orientation":t["x5-video-orientation"]||t.x5VideoOrientation,airplay:t.airplay,"webkit-airplay":t.airplay,tabindex:t.tabindex|0,mediaType:t.mediaType||"video","data-index":-1},t.videoConfig,t.videoAttributes);var i=t["x5-video-player-type"]||t.x5VideoPlayerType;return M.isWeixin&&M.os.isAndroid&&i&&(e.mediaConfig["x5-video-player-type"]=i,delete e.mediaConfig.playsinline,delete e.mediaConfig["webkit-playsinline"],delete e.mediaConfig["x5-playsinline"]),t.loop&&(e.mediaConfig.loop="loop"),t.autoplayMuted&&!Object.prototype.hasOwnProperty.call(e.mediaConfig,"muted")&&(e.mediaConfig.muted=!0),e.media=c.createDom(e.mediaConfig.mediaType,"",e.mediaConfig,""),t.defaultPlaybackRate&&(e.media.defaultPlaybackRate=e.media.playbackRate=t.defaultPlaybackRate),c.typeOf(t.volume)==="Number"&&(e.volume=t.volume),t.autoplayMuted&&(e.media.muted=!0,e._lastMuted=!0),t.autoplay&&(e.media.autoplay=!0),e._interval={},e.mediaEventMiddleware={},e.attachVideoEvents(),e}return x(r,[{key:"setEventsMiddleware",value:function(e){var i=this;Object.keys(e).map(function(n){i.mediaEventMiddleware[n]=e[n]})}},{key:"removeEventsMiddleware",value:function(e){var i=this;Object.keys(e).map(function(n){delete i.mediaEventMiddleware[n]})}},{key:"attachVideoEvents",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=Ji.map(function(n){var o="on".concat(n.charAt(0).toUpperCase()).concat(n.slice(1));return typeof e[o]=="function"&&e.on(n,e[o]),k({},n,en(n,e))})),this._evHandlers.forEach(function(n){var o=Object.keys(n)[0];i.addEventListener(o,n[o],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(n){var o=Object.keys(n)[0];i.removeEventListener(o,n[o],!1)}),this._evHandlers.forEach(function(n){var o=Object.keys(n)[0],u="on".concat(o.charAt(0).toUpperCase()).concat(o.slice(1));typeof e[u]=="function"&&e.off(o,e[u])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,i){var n=this;e.removeAttribute("src"),e.load(),i.forEach(function(h,d){n.media.appendChild(c.createDom("source","",{src:"".concat(h.src),type:"".concat(h.type||""),"data-index":d+1}))});var o=e.children;if(o){this._videoSourceCount=o.length,this._videoSourceIndex=o.length,this._vLoadeddata=function(h){n.emit(Qi,{src:h.target.currentSrc,host:c.getHostFromUrl(h.target.currentSrc)})};for(var u=null,l=0;l<this._evHandlers.length;l++)if(Object.keys(this._evHandlers[l])[0]==="error"){u=this._evHandlers[l];break}!this._sourceError&&(this._sourceError=function(h){var d=parseInt(h.target.getAttribute("data-index"),10);if(n._videoSourceIndex--,n._videoSourceIndex===0||d>=n._videoSourceCount){var v={code:4,message:"sources_load_error"};u?u.error(h,v):n.errorHandler("error",v)}var g=ot[4];n.emit(Zi,new $e(n,{errorType:g,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:h.target.src}))});for(var f=0;f<o.length;f++)o[f].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var i=e.children;if(!(!i||i.length===0||!this._sourceError)){for(var n=0;n<i.length;n++)i[n].removeEventListener("error",this._sourceError);for(;i.length>0;)e.removeChild(i[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||i)){var n=this.media.error||i,o=n.code?ot[n.code]:"other",u=n.message;this.media.currentSrc||(u="empty_src",n={code:6,message:u}),this.emit(e,new $e(this,{errorType:o,errorCode:n.code,errorMessage:n.message||"",mediaError:n}))}}},{key:"destroy",value:function(){this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null;for(var e in this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){var e=this.media?this.media.play():null;return e}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return this.media?this.media.canPlayType(e):!1}},{key:"getBufferedRange",value:function(e){var i=[0,0];if(!this.media)return i;e||(e=this.media.buffered);var n=this.media.currentTime;if(e)for(var o=0,u=e.length;o<u&&(i[0]=e.start(o),i[1]=e.end(o),!(i[0]<=n&&n<=i[1]));o++);return i[0]-n<=0&&n-i[1]<=0?i:[0,0]}},{key:"autoplay",get:function(){return this.media?this.media.autoplay:!1},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?c.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var i=this.media.buffered;if(!i||i.length===0)return e;for(var n=0;n<i.length;n++)if((i.start(n)<=this.currentTime||i.start(n)<.1)&&i.end(n)>=this.currentTime)return{start:i.start(n),end:i.end(n)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return this.media?this.media.defaultMuted:!1},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return this.media?this.media.ended:!1}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){var e=this.media.error;if(!e)return"";var i=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];return i[this.media.error.code-1]}},{key:"loop",get:function(){return this.media?this.media.loop:!1},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return this.media?this.media.muted:!1},set:function(e){!this.media||this.media.muted===e||(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return this.media?this.media.paused:!0}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){!this.media||e===1/0||(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return this.media?this.media.preload:!1},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return this.media?this.media.seekable:!1}},{key:"seeking",get:function(){return this.media?this.media.seeking:!1}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){if(this.media){if(this.emit(Je,e),this.emit(Nt),this._currentTime=0,this._duration=0,c.isMSE(this.media)){this.onWaiting();return}this._detachSourceEvents(this.media),c.typeOf(e)==="Array"?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()}}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e===1/0||!this.media||(this.media.volume=e)}},{key:"aspectRatio",get:function(){return this.media?this.media.videoWidth/this.media.videoHeight:0}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,i){for(var n,o=arguments.length,u=new Array(o>2?o-2:0),l=2;l<o;l++)u[l-2]=arguments[l];(n=S(b(r.prototype),"emit",this)).call.apply(n,[this,e,i].concat(u))}},{key:"on",value:function(e,i){for(var n,o=arguments.length,u=new Array(o>2?o-2:0),l=2;l<o;l++)u[l-2]=arguments[l];(n=S(b(r.prototype),"on",this)).call.apply(n,[this,e,i].concat(u))}},{key:"once",value:function(e,i){for(var n,o=arguments.length,u=new Array(o>2?o-2:0),l=2;l<o;l++)u[l-2]=arguments[l];(n=S(b(r.prototype),"once",this)).call.apply(n,[this,e,i].concat(u))}},{key:"off",value:function(e,i){for(var n,o=arguments.length,u=new Array(o>2?o-2:0),l=2;l<o;l++)u[l-2]=arguments[l];(n=S(b(r.prototype),"off",this)).call.apply(n,[this,e,i].concat(u))}},{key:"offAll",value:function(){S(b(r.prototype),"removeAllListeners",this).call(this)}}]),r}(xi),nn=function(){function a(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};w(this,a),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=s}return x(a,[{key:"openDB",value:function(r){var t=this,e=this,i=this.myDB.version||1,n=e.indexedDB.open(e.myDB.name,i);n.onerror=function(o){},n.onsuccess=function(o){t.myDB.db=o.target.result,r.call(e)},n.onupgradeneeded=function(o){var u=o.target.result;o.target.transaction,u.objectStoreNames.contains(e.myDB.ojstore.name)||u.createObjectStore(e.myDB.ojstore.name,{keyPath:e.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){var r=this;r.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(r,t){for(var e=this.myDB.db.transaction(r,"readwrite").objectStore(r),i,n=0;n<t.length;n++)i=e.add(t[n]),i.onerror=function(){},i.onsuccess=function(){}}},{key:"putData",value:function(r,t){for(var e=this.myDB.db.transaction(r,"readwrite").objectStore(r),i,n=0;n<t.length;n++)i=e.put(t[n]),i.onerror=function(){},i.onsuccess=function(){}}},{key:"getDataByKey",value:function(r,t,e){var i=this,n=this.myDB.db.transaction(r,"readwrite").objectStore(r),o=n.get(t);o.onerror=function(){e.call(i,null)},o.onsuccess=function(u){var l=u.target.result;e.call(i,l)}}},{key:"deleteData",value:function(r,t){var e=this.myDB.db.transaction(r,"readwrite").objectStore(r);e.delete(t)}},{key:"clearData",value:function(r){var t=this.myDB.db.transaction(r,"readwrite").objectStore(r);t.clear()}}]),a}(),dt=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],gt=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],vt=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],ue="data-xgplayerid";function xe(a,s,r){for(var t=arguments.length,e=new Array(t>3?t-3:0),i=3;i<t;i++)e[i-3]=arguments[i];var n=s.call.apply(s,[a].concat(e));!r||typeof r!="function"||(n&&n.then?n.then(function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];r.call.apply(r,[a].concat(u))}):r.call.apply(r,[a].concat(e)))}function Ae(a,s){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[a]&&(this.__hooks[a]=null),(function(){var t=arguments,e=this;if(r.pre)try{var i;(i=r.pre).call.apply(i,[this].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(a,":pre error] >> ").concat(u.message),u}if(this.__hooks&&this.__hooks[a])try{var n,o=(n=this.__hooks[a]).call.apply(n,[this,this].concat(Array.prototype.slice.call(arguments)));o?o.then?o.then(function(u){u!==!1&&xe.apply(void 0,[e,s,r.next].concat(J(t)))}).catch(function(u){throw u}):xe.apply(void 0,[this,s,r.next].concat(Array.prototype.slice.call(arguments))):o===void 0&&xe.apply(void 0,[this,s,r.next].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(a,"] >> ").concat(u.message),u}else xe.apply(void 0,[this,s,r.next].concat(Array.prototype.slice.call(arguments)))}).bind(this)}function Le(a,s){var r=this.__hooks;if(r)return r.hasOwnProperty(a)?(r&&(r[a]=s),!0):(console.warn("has no supported hook which name [".concat(a,"]")),!1)}function Oe(a,s){var r=this.__hooks;r&&delete r[a]}function pt(a){if(!(!this.plugins||!this.plugins[a.toLowerCase()])){for(var s=this.plugins[a.toLowerCase()],r=arguments.length,t=new Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];return s.useHooks&&s.useHooks.apply(s,t)}}function mt(a){if(!(!this.plugins||!this.plugins[a.toLowerCase()])){var s=this.plugins[a.toLowerCase()];if(s){for(var r=arguments.length,t=new Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];return s.removeHooks&&s.removeHooks.apply(s,t)}}}function jt(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];a.__hooks={},s&&s.map(function(r){a.__hooks[r]=null}),Object.defineProperty(a,"hooks",{get:function(){return a.__hooks&&Object.keys(a.__hooks).map(function(t){if(a.__hooks[t])return t})}})}function Wt(a){a.__hooks=null}function le(a,s,r){for(var t=arguments.length,e=new Array(t>3?t-3:0),i=3;i<t;i++)e[i-3]=arguments[i];if(a.__hooks&&a.__hooks[s]){var n,o=(n=a.__hooks[s]).call.apply(n,[a,a].concat(e));if(o&&o.then)o.then(function(u){return u===!1?null:r.call.apply(r,[a,a].concat(e))}).catch(function(u){console.warn("[runHooks]".concat(s," reject"),u.message)});else if(o!==!1)return r.call.apply(r,[a,a].concat(e))}else return r.call.apply(r,[a,a].concat(e))}function Ue(a,s){L.logError("[".concat(a,"] event or callback cant be undefined or null when call ").concat(s))}var Ze=function(){function a(s){w(this,a),c.checkIsFunction(this.beforeCreate)&&this.beforeCreate(s),jt(this),this.__args=s,this.__events={},this.__onceEvents={},this.config=s.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(s)}return x(a,[{key:"beforeCreate",value:function(r){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(r){this.player=r.player,this.playerConfig=r.player&&r.player.config,this.pluginName=r.pluginName?r.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=r.player&&r.player.logger}},{key:"updateLang",value:function(r){r||(r=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var r=c.checkTouchSupport()?"touch":"mouse";return this.playerConfig&&(this.playerConfig.domEventType==="touch"||this.playerConfig.domEventType==="mouse")&&(r=this.playerConfig.domEventType),r}},{key:"on",value:function(r,t){var e=this;if(!r||!t||!this.player){Ue(this.pluginName,"plugin.on(event, callback)");return}typeof r=="string"?(this.__events[r]=t,this.player.on(r,t)):Array.isArray(r)&&r.forEach(function(i){e.__events[i]=t,e.player.on(i,t)})}},{key:"once",value:function(r,t){var e=this;if(!r||!t||!this.player){Ue(this.pluginName,"plugin.once(event, callback)");return}typeof r=="string"?(this.__onceEvents[r]=t,this.player.once(r,t)):Array.isArray(r)&&r.forEach(function(i){e.__onceEvents[i]=t,e.player.once(r,t)})}},{key:"off",value:function(r,t){var e=this;if(!r||!t||!this.player){Ue(this.pluginName,"plugin.off(event, callback)");return}typeof r=="string"?(delete this.__events[r],this.player.off(r,t)):Array.isArray(r)&&r.forEach(function(i){delete e.__events[r],e.player.off(i,t)})}},{key:"offAll",value:function(){var r=this;["__events","__onceEvents"].forEach(function(t){Object.keys(r[t]).forEach(function(e){r[t][e]&&r.off(e,r[t][e]),e&&delete r[t][e]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(r){var t;if(this.player){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];(t=this.player).emit.apply(t,[r].concat(i))}}},{key:"emitUserAction",value:function(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.player){var i=W(W({},e),{},{pluginName:this.pluginName});this.player.emitUserAction(r,t,i)}}},{key:"hook",value:function(r,t){return Ae.call.apply(Ae,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(r,t){for(var e=arguments.length,i=new Array(e>2?e-2:0),n=2;n<e;n++)i[n-2]=arguments[n];return Le.call.apply(Le,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(r,t){for(var e=arguments.length,i=new Array(e>2?e-2:0),n=2;n<e;n++)i[n-2]=arguments[n];return Oe.call.apply(Oe,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(this.player)return e&&(t.pluginName=e),this.player.registerPlugin({plugin:r,options:t})}},{key:"getPlugin",value:function(r){return this.player?this.player.getPlugin(r):null}},{key:"__destroy",value:function(){var r=this,t=this.player,e=this.pluginName;this.offAll(),c.clearAllTimers(this),c.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(i){r[i]=null}),t.unRegisterPlugin(e),Wt(this)}}],[{key:"defineGetterOrSetter",value:function(r,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&Object.defineProperty(r,e,t[e])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}]),a}(),rn=9;if(typeof Element<"u"&&!Element.prototype.matches){var de=Element.prototype;de.matches=de.matchesSelector||de.mozMatchesSelector||de.msMatchesSelector||de.oMatchesSelector||de.webkitMatchesSelector}function sn(a,s){for(;a&&a.nodeType!==rn;){if(typeof a.matches=="function"&&a.matches(s))return a;a=a.parentNode}}var an=sn,on=an;function Ge(a,s,r,t,e){var i=ln.apply(this,arguments);return a.addEventListener(r,i,e),{destroy:function(){a.removeEventListener(r,i,e)}}}function un(a,s,r,t,e){return typeof a.addEventListener=="function"?Ge.apply(null,arguments):typeof r=="function"?Ge.bind(null,document).apply(null,arguments):(typeof a=="string"&&(a=document.querySelectorAll(a)),Array.prototype.map.call(a,function(i){return Ge(i,s,r,t,e)}))}function ln(a,s,r,t){return function(e){e.delegateTarget=on(e.target,s),e.delegateTarget&&t.call(a,e)}}var cn=un;const yt=Qe(cn);var fn={CONTROLS:"controls",ROOT:"root"},H={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},_t={ICON_DISABLE:"xg-icon-disable",ICON_HIDE:"xg-icon-hide"};function je(a){return a?a.indexOf&&/^(?:http|data:|\/)/.test(a):!1}function hn(a,s){return Y(a)==="object"&&a.class&&typeof a.class=="string"?"".concat(s," ").concat(a.class):s}function dn(a,s){return Y(a)==="object"&&a.attr&&Y(a.attr)==="object"&&Object.keys(a.attr).map(function(r){s[r]=a.attr[r]}),s}function Ct(a,s){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},e=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",i=null;if(a instanceof window.Element)return c.addClass(a,r),Object.keys(t).map(function(n){a.setAttribute(n,t[n])}),a;if(je(a)||je(a.url))return t.src=je(a)?a:a.url||"",i=c.createDom(a.tag||"img","",t,"xg-img ".concat(r)),i;if(typeof a=="function")try{return i=a(),i instanceof window.Element?(c.addClass(i,r),Object.keys(t).map(function(n){i.setAttribute(n,t[n])}),i):(L.logWarn("warn>>icons.".concat(s," in config of plugin named [").concat(e,"] is a function mast return an Element Object")),null)}catch(n){return L.logError("Plugin named [".concat(e,"]:createIcon"),n),null}return typeof a=="string"?c.createDomFromHtml(a,t,r):(L.logWarn("warn>>icons.".concat(s," in config of plugin named [").concat(e,"] is invalid")),null)}function gn(a,s){var r=s.config.icons||s.playerConfig.icons;Object.keys(a).map(function(t){var e=a[t],i=e&&e.class?e.class:"",n=e&&e.attr?e.attr:{},o=null;r&&r[t]&&(i=hn(r[t],i),n=dn(r[t],n),o=Ct(r[t],t,i,n,s.pluginName)),!o&&e&&(o=Ct(e.icon?e.icon:e,n,i,{},s.pluginName)),s.icons[t]=o})}function vn(a,s){Object.keys(a).map(function(r){Object.defineProperty(s.langText,r,{get:function(){var e=s.lang,i=s.i18n;return i[r]?i[r]:a[r]&&a[r][e]||""}})})}var B=function(a){R(r,a);var s=D(r);function r(){var t,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return w(this,r),t=s.call(this,e),t.__delegates=[],t}return x(r,[{key:"__init",value:function(e){if(S(b(r.prototype),"__init",this).call(this,e),!!e.root){var i=e.root,n=null;this.icons={},this.root=null,this.parent=null;var o=this.registerIcons()||{};gn(o,this),this.langText={};var u=this.registerLanguageTexts()||{};vn(u,this);var l="";try{l=this.render()}catch(d){throw L.logError("Plugin:".concat(this.pluginName,":render"),d),new Error("Plugin:".concat(this.pluginName,":render:").concat(d.message))}if(l)n=r.insert(l,i,e.index),n.setAttribute("data-index",e.index);else if(e.tag)n=c.createDom(e.tag,"",e.attr,e.name),n.setAttribute("data-index",e.index),i.appendChild(n);else return;this.root=n,this.parent=i;var f=this.config.attr||{},h=this.config.style||{};this.setAttr(f),this.setStyle(h),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var i=this.children();i&&Y(i)==="object"&&Object.keys(i).length>0&&Object.keys(i).map(function(n){var o=n,u=i[o],l={root:e.root},f,h;typeof u=="function"?(f=e.config[o]||{},h=u):Y(u)==="object"&&typeof u.plugin=="function"&&(f=u.options?c.deepCopy(e.config[o]||{},u.options):e.config[o]||{},h=u.plugin),l.config=f,f.index!==void 0&&(l.index=f.index),f.root&&(l.root=f.root),e.registerPlugin(h,l,o)})}}},{key:"updateLang",value:function(e){e||(e=this.lang);function i(l,f){for(var h=0;h<l.children.length;h++)l.children[h].children.length>0?i(l.children[h],f):f(l.children[h])}var n=this.root,o=this.i18n,u=this.langText;n&&i(n,function(l){var f=l.getAttribute&&l.getAttribute("lang-key");if(f){var h=o[f.toUpperCase()]||u[f];h&&(l.innerHTML=typeof h=="function"?h(e):h)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=this.i18n||{},o=this.langText;e.setAttribute&&e.setAttribute("lang-key",i);var u=n[i]||o[i]||"";u&&(e.innerHTML=u)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,c.addClass(this.find(".xgplayer-icon"),_t.ICON_DISABLE)}},{key:"enable",value:function(){this.config.disable=!1,c.removeClass(this.find(".xgplayer-icon"),_t.ICON_DISABLE)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";i.root=i.root||this.root;var o=S(b(r.prototype),"registerPlugin",this).call(this,e,i,n);return this._children.push(o),o}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,i,n){var o=this;if(arguments.length<3&&typeof i=="function")Array.isArray(e)?e.forEach(function(l){o.bindEL(l,i)}):this.bindEL(e,i);else{var u=r.delegate.call(this,this.root,e,i,n);this.__delegates=this.__delegates.concat(u)}}},{key:"unbind",value:function(e,i){var n=this;if(arguments.length<3&&typeof i=="function")Array.isArray(e)?e.forEach(function(l){n.unbindEL(l,i)}):this.unbindEL(e,i);else for(var o="".concat(e,"_").concat(i),u=0;u<this.__delegates.length;u++)if(this.__delegates[u].key===o){this.__delegates[u].destroy(),this.__delegates.splice(u,1);break}}},{key:"setStyle",value:function(e,i){var n=this;if(this.root){if(c.typeOf(e)==="String")return this.root.style[e]=i;c.typeOf(e)==="Object"&&Object.keys(e).map(function(o){n.root.style[o]=e[o]})}}},{key:"setAttr",value:function(e,i){var n=this;if(this.root){if(c.typeOf(e)==="String")return this.root.setAttribute(e,i);c.typeOf(e)==="Object"&&Object.keys(e).map(function(o){n.root.setAttribute(o,e[o])})}}},{key:"setHtml",value:function(e,i){this.root&&(this.root.innerHTML=e,typeof i=="function"&&i())}},{key:"bindEL",value:function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof i=="function"&&this.root.addEventListener(e,i,n)}},{key:"unbindEL",value:function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof i=="function"&&this.root.removeEventListener(e,i,n)}},{key:"show",value:function(e){if(this.root){this.root.style.display=e!==void 0?e:"block";var i=window.getComputedStyle(this.root,null),n=i.getPropertyValue("display");if(n==="none")return this.root.style.display="block"}}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,i){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!i||!(i instanceof window.Element))return null;try{return typeof e=="string"?this.find(e).appendChild(i):e.appendChild(i)}catch(n){return L.logError("Plugin:appendChild",n),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,i=this.player;this.__delegates.map(function(n){n.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(n){i.unRegisterPlugin(n.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),S(b(r.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(n){e[n]=null})}}],[{key:"insert",value:function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=i.children.length,u=Number(n),l=e instanceof window.Node;if(o){for(var f=0,h=null,d="";f<o;f++){h=i.children[f];var v=Number(h.getAttribute("data-index"));if(v>=u){d="beforebegin";break}else v<u&&(d="afterend")}return l?d==="afterend"?i.appendChild(e):i.insertBefore(e,h):h.insertAdjacentHTML(d,e),d==="afterend"?i.children[i.children.length-1]:i.children[f]}else return l?i.appendChild(e):i.insertAdjacentHTML("beforeend",e),i.children[i.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,i,n,o){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=[];if(e instanceof window.Node&&typeof o=="function")if(Array.isArray(n))n.forEach(function(h){var d=yt(e,i,h,o,u);d.key="".concat(i,"_").concat(h),l.push(d)});else{var f=yt(e,i,n,o,u);f.key="".concat(i,"_").concat(n),l.push(f)}return l}},{key:"ROOT_TYPES",get:function(){return fn}},{key:"POSITIONS",get:function(){return H}}]),r}(Ze),pn=function(){function a(){var s=this;if(w(this,a),k(this,"__trigger",function(r){var t=new Date().getTime();s.timeStamp=t;for(var e=0;e<r.length;e++)s.__runHandler(r[e].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(Ri(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(r){console.error(r)}}return x(a,[{key:"addObserver",value:function(r,t){if(this.observer){this.observer&&this.observer.observe(r);for(var e=r.getAttribute(ue),i=this.__handlers,n=-1,o=0;o<i.length;o++)i[o]&&r===i[o].target&&(n=o);n>-1?this.__handlers[n].handler=t:this.__handlers.push({target:r,handler:t,playerId:e})}}},{key:"unObserver",value:function(r){var t=-1;this.__handlers.map(function(e,i){r===e.target&&(t=i)});try{this.observer&&this.observer.unobserve(r)}catch{}this.observer&&this.observer.unobserve(r),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(r){for(var t=this.__handlers,e=0;e<t.length;e++)if(t[e]&&r===t[e].target){try{t[e].handler(r)}catch(i){console.error(i)}return!0}return!1}}]),a}(),ke=null;function mn(a,s){return ke||(ke=new pn),ke.addObserver(a,s),ke}function yn(a,s){ke.unObserver(a,s)}var G={pluginGroup:{},init:function(s){var r=s._pluginInfoId;r||(r=new Date().getTime(),s._pluginInfoId=r),!s.config.closeResizeObserver&&mn(s.root,function(){s.resize()}),this.pluginGroup[r]={_originalOptions:s.config||{},_plugins:{}}},formatPluginInfo:function(s,r){var t=null,e=null;return s.plugin&&typeof s.plugin=="function"?(t=s.plugin,e=s.options):(t=s,e={}),r&&(e.config=r||{}),{PLUFGIN:t,options:e}},checkPluginIfExits:function(s,r){for(var t=0;t<r.length;t++)if(s.toLowerCase()===r[t].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(s,r){for(var t=Object.keys(r),e=null,i=0;i<t.length;i++)if(s.toLowerCase()===t[i].toLowerCase()){e=r[t[i]];break}return c.typeOf(e)==="Object"?{root:e.root,position:e.position}:{}},lazyRegister:function(s,r){var t=this,e=r.timeout||1500;return Promise.race([r.loader().then(function(i){var n;i&&i.__esModule?n=i.default:n=i,t.register(s,n,i.options)}),new Promise(function(i,n){setTimeout(function(){n(new Error("timeout"))},e)})])},register:function(s,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!s||!r||typeof r!="function"||r.prototype===void 0)){var e=s._pluginInfoId;if(!(!e||!this.pluginGroup[e])){this.pluginGroup[e]._plugins||(this.pluginGroup[e]._plugins={});var i=this.pluginGroup[e]._plugins,n=this.pluginGroup[e]._originalOptions;t.player=s;var o=t.pluginName||r.pluginName;if(!o)throw new Error("The property pluginName is necessary");if(r.isSupported&&!r.isSupported(s.config.mediaType,s.config.codecType)){console.warn("not supported plugin [".concat(o,"]"));return}t.config||(t.config={});for(var u=Object.keys(n),l=0;l<u.length;l++)if(o.toLowerCase()===u[l].toLowerCase()){var f=n[u[l]];c.typeOf(f)==="Object"?t.config=Object.assign({},t.config,n[u[l]]):c.typeOf(f)==="Boolean"&&(t.config.disable=!f);break}r.defaultConfig&&Object.keys(r.defaultConfig).forEach(function(d){typeof t.config[d]>"u"&&(t.config[d]=r.defaultConfig[d])}),t.root?typeof t.root=="string"&&(t.root=s[t.root]):t.root=s.root,t.index=t.config.index||0;try{i[o.toLowerCase()]&&(this.unRegister(e,o.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(o,"] exist, destroy the old instance")));var h=new r(t);return i[o.toLowerCase()]=h,i[o.toLowerCase()].func=r,h&&typeof h.afterCreate=="function"&&h.afterCreate(),h}catch(d){throw console.error(d),d}}}},unRegister:function(s,r){s._pluginInfoId&&(s=s._pluginInfoId),r=r.toLowerCase();try{var t=this.pluginGroup[s]._plugins[r];t&&(t.pluginName&&t.__destroy(),delete this.pluginGroup[s]._plugins[r])}catch(e){console.error("[unRegister:".concat(r,"] cgid:[").concat(s,"] error"),e)}},deletePlugin:function(s,r){var t=s._pluginInfoId;t&&this.pluginGroup[t]&&this.pluginGroup[t]._plugins&&delete this.pluginGroup[t]._plugins[r]},getPlugins:function(s){var r=s._pluginInfoId;return r&&this.pluginGroup[r]?this.pluginGroup[r]._plugins:{}},findPlugin:function(s,r){var t=s._pluginInfoId;if(!t||!this.pluginGroup[t])return null;var e=r.toLowerCase();return this.pluginGroup[t]._plugins[e]},beforeInit:function(s){var r=this;function t(e){return!e||!e.then?new Promise(function(i){i()}):e}return new Promise(function(e){if(r.pluginGroup){var i;return s._loadingPlugins&&s._loadingPlugins.length?i=Promise.all(s._loadingPlugins):i=Promise.resolve(),i.then(function(){var n=s._pluginInfoId;if(!r.pluginGroup[n]){e();return}var o=r.pluginGroup[n]._plugins,u=[];Object.keys(o).forEach(function(l){if(o[l]&&o[l].beforePlayerInit)try{var f=o[l].beforePlayerInit();u.push(t(f))}catch(h){throw u.push(t(null)),h}}),Promise.all([].concat(u)).then(function(){e()}).catch(function(l){console.error(l),e()})})}})},afterInit:function(s){var r=s._pluginInfoId;if(!(!r||!this.pluginGroup[r])){var t=this.pluginGroup[r]._plugins;Object.keys(t).forEach(function(e){t[e]&&t[e].afterPlayerInit&&t[e].afterPlayerInit()})}},setLang:function(s,r){var t=r._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=this.pluginGroup[t]._plugins;Object.keys(e).forEach(function(i){if(e[i].updateLang)e[i].updateLang(s);else try{e[i].lang=s}catch{console.warn("".concat(i," setLang"))}})}},reRender:function(s){var r=this,t=s._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=[],i=this.pluginGroup[t]._plugins;Object.keys(i).forEach(function(n){n!=="controls"&&i[n]&&(e.push({plugin:i[n].func,options:i[n].__args}),r.unRegister(t,n))}),e.forEach(function(n){r.register(s,n.plugin,n.options)})}},onPluginsReady:function(s){var r=s._pluginInfoId;if(!(!r||!this.pluginGroup[r])){var t=this.pluginGroup[r]._plugins||{};Object.keys(t).forEach(function(e){t[e].onPluginsReady&&typeof t[e].onPluginsReady=="function"&&t[e].onPluginsReady()})}},destroy:function(s){var r=s._pluginInfoId;if(this.pluginGroup[r]){yn(s.root);for(var t=this.pluginGroup[r]._plugins,e=0,i=Object.keys(t);e<i.length;e++){var n=i[e];this.unRegister(r,n)}delete this.pluginGroup[r],delete s._pluginInfoId}}},y={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function Et(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:Di(),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var _n=function(s,r){var t,e,i;r.preset&&r.options?i=new r.preset(r.options,s.config):i=new r({},s.config);var n=i,o=n.plugins,u=o===void 0?[]:o,l=n.ignores,f=l===void 0?[]:l,h=n.icons,d=h===void 0?{}:h,v=n.i18n,g=v===void 0?[]:v;s.config.plugins||(s.config.plugins=[]),s.config.ignores||(s.config.ignores=[]),(t=s.config.plugins).push.apply(t,J(u)),(e=s.config.ignores).push.apply(e,J(f)),Object.keys(d).map(function(p){s.config.icons[p]||(s.config.icons[p]=d[p])});var m=s.config.i18n||[];g.push.apply(g,J(m)),s.config.i18n=g},Cn=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"onMouseEnter",function(o){var u=_(t),l=u.player,f=u.playerConfig;f.closeControlsBlur&&l.focus({autoHide:!1})}),k(_(t),"onMouseLeave",function(o){var u=_(t),l=u.player;l.focus()}),t}return x(r,[{key:"beforeCreate",value:function(e){!e.config.mode&&M.device==="mobile"&&(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,i=this.config,n=i.disable,o=i.height,u=i.mode;if(!n){u==="flex"&&this.player.addClass(y.FLEX_CONTROLS);var l={height:"".concat(o,"px")};Object.keys(l).map(function(h){e.root.style[h]=l[h]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(Ki,function(h){h?c.addClass(e.root,"mini-controls"):c.removeClass(e.root,"mini-controls")});var f=this.playerConfig.isMobileSimulateMode;M.device!=="mobile"&&f!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&c.addClass(this.root,y.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){c.removeClass(this.root,y.CONTROLS_AUTOHIDE)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.root){var o=e.defaultConfig||{};if(!i.root){var u=i.position?i.position:i.config&&i.config.position?i.config.position:o.position;switch(u){case H.CONTROLS_LEFT:i.root=this.left;break;case H.CONTROLS_RIGHT:i.root=this.right;break;case H.CONTROLS_CENTER:i.root=this.center;break;case H.CONTROLS:i.root=this.root;break;default:i.root=this.left}return S(b(r.prototype),"registerPlugin",this).call(this,e,i,n)}}}},{key:"destroy",value:function(){M.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,i=e.mode,n=e.autoHide,o=e.initShow,u=e.disable;if(!u){var l=c.classNames({"xgplayer-controls":!0},{"flex-controls":i==="flex"},{"bottom-controls":i==="bottom"},k({},y.CONTROLS_AUTOHIDE,n),{"xgplayer-controls-initshow":o||!n});return'<xg-controls class="'.concat(l,`" unselectable="on">
    <xg-inner-controls class="xg-inner-controls xg-pos">
      <xg-left-grid class="xg-left-grid">
      </xg-left-grid>
      <xg-center-grid class="xg-center-grid"></xg-center-grid>
      <xg-right-grid class="xg-right-grid">
      </xg-right-grid>
    </xg-inner-controls>
    </xg-controls>`)}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),r}(B),En={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},X={lang:{},langKeys:[],textKeys:[]};function be(a,s){return Object.keys(s).forEach(function(r){var t=c.typeOf(s[r]),e=c.typeOf(a[r]);if(t==="Array"){var i;e!=="Array"&&(a[r]=[]),(i=a[r]).push.apply(i,J(s[r]))}else t==="Object"?(e!=="Object"&&(a[r]={}),be(a[r],s[r])):a[r]=s[r]}),a}function Vt(){Object.keys(X.lang.en).map(function(a){X.textKeys[a]=a})}function kn(a,s){var r=[];if(s||(s=X),!!s.lang){c.typeOf(a)!=="Array"?r=Object.keys(a).map(function(i){var n=i==="zh"?"zh-cn":i;return{LANG:n,TEXT:a[i]}}):r=a;var t=s,e=t.lang;r.map(function(i){i.LANG==="zh"&&(i.LANG="zh-cn"),e[i.LANG]?be(e[i.LANG]||{},i.TEXT||{}):tt(i,s)}),Vt()}}function tt(a,s){var r=a.LANG;if(s||(s=X),!!s.lang){var t=a.TEXT||{};r==="zh"&&(r="zh-cn"),s.lang[r]?be(s.lang[r],t):(s.langKeys.push(r),s.lang[r]=t),Vt()}}function Tn(a){var s,r={lang:{},langKeys:[],textKeys:{},pId:a};return be(r.lang,X.lang),(s=r.langKeys).push.apply(s,J(X.langKeys)),be(r.textKeys,X.textKeys),r}tt(En);var Ie={get textKeys(){return X.textKeys},get langKeys(){return X.langKeys},get lang(){var a={};return X.langKeys.map(function(s){a[s]=X.lang[s]}),X.lang["zh-cn"]&&(a.zh=X.lang["zh-cn"]||{}),a},extend:kn,use:tt,init:Tn},A={INITIAL:1,READY:2,ATTACHING:3,ATTACHED:4,NOTALLOW:5,RUNNING:6,ENDED:7,DESTROYED:8},kt=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],z={},We=null,bn=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"add",value:function(e){e&&(z[e.playerId]=e,Object.keys(z).length===1&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete z[e.playerId])}},{key:"_iterate",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(var n in z)if(Object.prototype.hasOwnProperty.call(z,n)){var o=z[n];if(i){if(e(o))break}else e(o)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var i=null;return this._iterate(function(n){var o=e(n);return o&&(i=n),o},!0),i}},{key:"findAll",value:function(e){var i=[];return this._iterate(function(n){e(n)&&i.push(n)}),i}},{key:"setActive",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(z[e])return i?this.forEach(function(n){e===n.playerId?(n.isUserActive=!0,n.isInstNext=!1):n.isUserActive=!1}):z[e].isUserActive=i,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(z),i=0;i<e.length;i++){var n=z[e[i]];if(n&&n.isUserActive)return e[i]}return null}},{key:"setNext",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(z[e])return i?this.forEach(function(n){e===n.playerId?(n.isUserActive=!1,n.isInstNext=!0):n.isInstNext=!1}):z[e].isInstNext=i,e}}],[{key:"getInstance",value:function(){return We||(We=new r),We}}]),r}(Ot.EventEmitter);function Sn(a){for(var s=Object.keys(z),r=0;r<s.length;r++){var t=z[s[r]];if(t.root===a)return t}return null}var wn=["play","pause","replay","retry"],Tt=0,bt=0,ee=null,Se=function(a){R(r,a);var s=D(r);function r(t){var e;w(this,r);var i=c.deepMerge(Et(),t);e=s.call(this,i),k(_(e),"canPlayFunc",function(){if(e.config){var g=e.config,m=g.autoplay,p=g.defaultPlaybackRate;L.logInfo("player","canPlayFunc, startTime",e.__startTime),e.__startTime>0&&e.duration>0&&(e.currentTime=e.__startTime>e.duration?e.duration:e.__startTime,e.__startTime=-1),e.playbackRate=p,(m||e._useAutoplay)&&e.mediaPlay(),e.off(ce,e.canPlayFunc),e.removeClass(y.ENTER)}}),k(_(e),"onFullscreenChange",function(g,m){var p=function(){c.setTimeout(_(e),function(){e.resize()},100)},T=c.getFullScreenEl();e._fullActionFrom?e._fullActionFrom="":e.emit(ht,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:e.currentTime,duration:e.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var E=Ni(T,e.playerId,ue);if(m||T&&(T===e._fullscreenEl||E))p(),!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!0,e.changeFullStyle(e.root,T,y.FULLSCREEN),e.emit(ne,!0,e._fullScreenOffset),e.cssfullscreen&&e.exitCssFullscreen();else if(e.fullscreen){p();var C=_(e),N=C._fullScreenOffset,P=C.config;if(P.needFullscreenScroll?(window.scrollTo(N.left,N.top),c.setTimeout(_(e),function(){e.fullscreen=!1,e._fullScreenOffset=null},100)):(!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!1,e._fullScreenOffset=null),e.cssfullscreen)e.removeClass(y.FULLSCREEN);else{var F=e._fullscreenEl;!F&&(e.root.contains(g.target)||g.target===e.root)&&(F=g.target),e.recoverFullStyle(e.root,F,y.FULLSCREEN)}e._fullscreenEl=null,e.emit(ne,!1)}}),k(_(e),"_onWebkitbeginfullscreen",function(g){e._fullscreenEl=e.media,e.onFullscreenChange(g,!0)}),k(_(e),"_onWebkitendfullscreen",function(g){e.onFullscreenChange(g,!1)}),jt(_(e),wn),e.config=i,e._pluginInfoId=c.generateSessionId(),Pi(_(e));var n=e.constructor.defaultPreset;if(e.config.presets.length){var o=e.config.presets.indexOf("default");o>=0&&n&&(e.config.presets[o]=n)}else n&&e.config.presets.push(n);e.userTimer=null,e.waitTimer=null,e.handleSource=!0,e._state=A.INITIAL,e.isError=!1,e._hasStart=!1,e.isSeeking=!1,e.isCanplay=!1,e._useAutoplay=!1,e.__startTime=-1,e.rotateDeg=0,e.isActive=!1,e.fullscreen=!1,e.cssfullscreen=!1,e.isRotateFullscreen=!1,e._fullscreenEl=null,e.timeSegments=[],e._cssfullscreenEl=null,e.curDefinition=null,e._orgCss="",e._fullScreenOffset=null,e._videoHeight=0,e._videoWidth=0,e.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},e.sizeInfo={width:0,height:0,left:0,top:0},e._accPlayed={t:0,acc:0,loopAcc:0},e._offsetInfo={currentTime:-1,duration:0},e.innerContainer=null,e.controls=null,e.topBar=null,e.root=null,e.__i18n=Ie.init(e._pluginInfoId),M.os.isAndroid&&M.osVersion>0&&M.osVersion<6&&(e.config.autoplay=!1),e.database=new nn,e.isUserActive=!1,e._onceSeekCanplay=null,e._isPauseBeforeSeek=0,e.innerStates={isActiveLocked:!1},e.instManager=ee;var u=e._initDOM();if(!u)return console.error(new Error("can't find the dom which id is ".concat(e.config.id," or this.config.el does not exist"))),Pt(e);var l=e.config,f=l.definition,h=f===void 0?{}:f,d=l.url;if(!d&&h.list&&h.list.length>0){var v=h.list.find(function(g){return g.definition&&g.definition===h.defaultDefinition});v||(h.defaultDefinition=h.list[0].definition,v=h.list[0]),e.config.url=v.url,e.curDefinition=v}return e._bindEvents(),e._registerPresets(),e._registerPlugins(),G.onPluginsReady(_(e)),e.getInitDefinition(),e.setState(A.READY),c.setTimeout(_(e),function(){e.emit(Mt)},0),e.onReady&&e.onReady(),(e.config.videoInit||e.config.autoplay)&&(!e.hasStart||e.state<A.ATTACHED)&&e.start(),e}return x(r,[{key:"_initDOM",value:function(){var e,i=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var n=this.config.el;if(n&&n.nodeType===1)this.root=n;else return this.emit(De,new $e("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1}var o=Sn(this.root);o&&(L.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),o.destroy()),this.root.setAttribute(ue,this.playerId),(e=ee)===null||e===void 0||e.add(this),G.init(this),this._initBaseDoms();var u=this.constructor.XgVideoProxy;if(u&&this.mediaConfig.mediaType===u.mediaType){var l=this.innerContainer||this.root;this.detachVideoEvents(this.media);var f=new u(l,this.config,this.mediaConfig);this.attachVideoEvents(f),this.media=f}if(this.media.setAttribute(ue,this.playerId),this.config.controls){var h=this.config.controls.root||null,d=G.register(this,Cn,{root:h});this.controls=d}var v=this.config.isMobileSimulateMode==="mobile"?"mobile":M.device;if(this.addClass("".concat(y.DEFAULT," ").concat(y.INACTIVE," xgplayer-").concat(v," ").concat(this.config.controls?"":y.NO_CONTROLS)),this.config.autoplay?this.addClass(y.ENTER):this.addClass(y.NO_START),this.config.fluid){var g=this.config,m=g.width,p=g.height;(typeof m!="number"||typeof p!="number")&&(m=600,p=337.5);var T={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(p*100/m,"%")};Object.keys(T).forEach(function(I){i.root.style[I]=T[I]})}else["width","height"].forEach(function(I){i.config[I]&&(typeof i.config[I]!="number"?i.root.style[I]=i.config[I]:i.root.style[I]="".concat(i.config[I],"px"))});var E=this.root.getBoundingClientRect(),C=E.width,N=E.height,P=E.left,F=E.top;return this.sizeInfo.width=C,this.sizeInfo.height=N,this.sizeInfo.left=P,this.sizeInfo.top=F,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=c.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(i){e.on(i,e["on"+i.charAt(0).toUpperCase()+i.slice(1)])}),dt.forEach(function(i){document&&document.addEventListener(i,e.onFullscreenChange)}),M.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(Pe,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(ye,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),dt.forEach(function(i){document.removeEventListener(i,e.onFullscreenChange)}),this.playFunc&&this.off(ye,this.playFunc),this.off(ce,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_clearUserTimer",value:function(){this.userTimer&&(c.clearTimeout(this,this.userTimer),this.userTimer=null)}},{key:"_startInit",value:function(e){var i=this;if(this.media&&!((!e||e===""||c.typeOf(e)==="Array"&&e.length===0)&&(e="",this.emit(Vi),L.logWarn("config.url is null, please get url and run player._startInit(url)"),this.config.nullUrlStart))){this.handleSource&&(this._detachSourceEvents(this.media),c.typeOf(e)==="Array"&&e.length>0?this._attachSourceEvents(this.media,e):!this.media.src||this.media.src!==e?this.media.src=e:e||this.media.removeAttribute("src")),c.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var n=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!n.contains(this.media)&&n.insertBefore(this.media,n.firstChild);var o=this.media.readyState;L.logInfo("_startInit readyState",o),this.config.autoplay&&(!c.isMSE(this.media)&&this.load(),(M.os.isIpad||M.os.isPhone)&&this.mediaPlay());var u=this.config.startTime;this.__startTime=u>0?u:-1,this.config.startTime=0,o>=2&&this.duration>0?this.canPlayFunc():this.on(ce,this.canPlayFunc),(!this.hasStart||this.state<A.ATTACHED)&&G.afterInit(this),this.hasStart=!0,this.setState(A.ATTACHED),c.setTimeout(this,function(){i.emit(Bt)},0)}}},{key:"_registerPlugins",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._loadingPlugins=[];var n=this.config.ignores||[],o=this.config.plugins||[],u=this.config.i18n||[];i&&Ie.extend(u,this.__i18n);var l=n.join("||").toLowerCase().split("||"),f=this.plugins;o.forEach(function(h){try{var d=h.plugin?h.plugin.pluginName:h.pluginName;if(d&&l.indexOf(d.toLowerCase())>-1)return null;if(!i&&f[d.toLowerCase()])return;if(h.lazy&&h.loader){var v=G.lazyRegister(e,h);h.forceBeforeInit&&(v.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(v),1)}).catch(function(g){L.logError("_registerPlugins:loadingPlugin",g),e._loadingPlugins.splice(e._loadingPlugins.indexOf(v),1)}),e._loadingPlugins.push(v));return}return e.registerPlugin(h)}catch(g){L.logError("_registerPlugins:",g)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(i){_n(e,i)})}},{key:"_getRootByPosition",value:function(e){var i=null;switch(e){case H.ROOT_RIGHT:this.rightBar||(this.rightBar=c.createPositionBar("xg-right-bar",this.root)),i=this.rightBar;break;case H.ROOT_LEFT:this.leftBar||(this.leftBar=c.createPositionBar("xg-left-bar",this.root)),i=this.leftBar;break;case H.ROOT_TOP:this.topBar||(this.topBar=c.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&c.addClass(this.topBar,y.TOP_BAR_AUTOHIDE)),i=this.topBar;break;default:i=this.innerContainer||this.root;break}return i}},{key:"registerPlugin",value:function(e,i){var n=G.formatPluginInfo(e,i),o=n.PLUFGIN,u=n.options,l=this.config.plugins,f=G.checkPluginIfExits(o.pluginName,l);!f&&l.push(o);var h=G.getRootByConfig(o.pluginName,this.config);h.root&&(u.root=h.root),h.position&&(u.position=h.position);var d=u.position?u.position:u.config&&u.config.position||o.defaultConfig&&o.defaultConfig.position;return!u.root&&typeof d=="string"&&d.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(o,u,o.pluginName):(u.root||(u.root=this._getRootByPosition(d)),G.register(this,o,u))}},{key:"deregister",value:function(e){typeof e=="string"?G.unRegister(this,e):e instanceof Ze&&G.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.deregister(e),i&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var i;if(typeof e=="string"?i=e:e instanceof Ze&&(i=e.pluginName),!!i)for(var n=this.config.plugins.length-1;n>-1;n--){var o=this.config.plugins[n];if(o.pluginName.toLowerCase()===i.toLowerCase()){this.config.plugins.splice(n,1);break}}}},{key:"plugins",get:function(){return G.getPlugins(this)}},{key:"getPlugin",value:function(e){var i=G.findPlugin(this,e);return i&&i.pluginName?i:null}},{key:"addClass",value:function(e){this.root&&(c.hasClass(this.root,e)||c.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&c.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return c.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,i){this.root&&this.root.setAttribute(e,i)}},{key:"removeAttribute",value:function(e,i){this.root&&this.root.removeAttribute(e,i)}},{key:"start",value:function(e){var i=this;if(!(this.state>A.ATTACHING))return!e&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this.setState(A.ATTACHING),this._registerPlugins(!1),G.beforeInit(this).then(function(){if(i.config){e||(e=i.url||i.config.url);var n=i._preProcessUrl(e),o=i._startInit(n.url);return o}}).catch(function(n){throw n.fileName="player",n.lineNumber="236",L.logError("start:beforeInit:",n),n})}},{key:"switchURL",value:function(e,i){var n=this,o=e;c.typeOf(e)==="Object"&&(o=e.url),o=this._preProcessUrl(o).url;var u=this.currentTime;this.__startTime=u;var l=this.paused&&!this.isError;return this.src=o,new Promise(function(f,h){var d=function(m){n.off("timeupdate",v),n.off("canplay",v),h(m)},v=function(){n.duration>0&&n.__startTime>0&&(n.currentTime=n.__startTime,n.__startTime=-1),l&&n.pause(),n.off("error",d),f(!0)};if(n.once("error",d),!o){n.errorHandler("error",{code:6,message:"empty_src"});return}M.os.isAndroid?n.once("timeupdate",v):n.once("canplay",v),n.play()})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<A.ATTACHED){this.removeClass(y.NO_START),this.addClass(y.ENTER),this.start(),this._useAutoplay=!0;return}this.state<A.RUNNING&&(this.removeClass(y.NO_START),!this.isCanplay&&this.addClass(y.ENTER));var i=S(b(r.prototype),"play",this).call(this);return i!==void 0&&i&&i.then?i.then(function(){e.removeClass(y.NOT_ALLOW_AUTOPLAY),e.addClass(y.PLAYING),e.state<A.RUNNING&&(L.logInfo(">>>>playPromise.then"),e.setState(A.RUNNING),e.emit(me))}).catch(function(n){if(L.logWarn(">>>>playPromise.catch",n.name),e.media&&e.media.error){e.onError(),e.removeClass(y.ENTER);return}n.name==="NotAllowedError"&&(e._errorTimer=c.setTimeout(e,function(){e._errorTimer=null,e.emit(Ht),e.addClass(y.NOT_ALLOW_AUTOPLAY),e.removeClass(y.ENTER),e.pause(),e.setState(A.NOTALLOW)},0))}):(L.logWarn("video.play not return promise"),this.state<A.RUNNING&&(this.setState(A.RUNNING),this.removeClass(y.NOT_ALLOW_AUTOPLAY),this.removeClass(y.NO_START),this.removeClass(y.ENTER),this.addClass(y.PLAYING),this.emit(me))),i}},{key:"mediaPause",value:function(){S(b(r.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){S(b(r.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this.removeClass(y.PAUSED),le(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;le(this,"pause",function(){S(b(r.prototype),"pause",e).call(e)})}},{key:"seek",value:function(e,i){var n=this;if(!(!this.media||Number.isNaN(Number(e))||!this.hasStart)){var o=this.config,u=o.isSeekedPlay,l=o.seekedStatus,f=i||(u?"play":l);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(re,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(n.removeClass(y.ENTER),n.isSeeking=!1,f){case"play":n.play();break;case"pause":n.pause();break;default:n._isPauseBeforeSeek>1||n.paused?n.pause():n.play()}n._isPauseBeforeSeek=0,n._onceSeekCanplay=null},this.once(re,this._onceSeekCanplay),this.state<A.RUNNING?(this.removeClass(y.NO_START),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,i=this.config,n=i.definition,o=i.url;!o&&n&&n.list&&n.list.length>0&&n.defaultDefinition&&n.list.map(function(u){u.definition===n.defaultDefinition&&(e.config.url=u.url,e.curDefinition=u)})}},{key:"changeDefinition",value:function(e,i){var n=this,o=this.config.definition;if(Array.isArray(o==null?void 0:o.list)&&o.list.forEach(function(l){(e==null?void 0:e.definition)===l.definition&&(n.curDefinition=l)}),e!=null&&e.bitrate&&typeof e.bitrate!="number"&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit(Gt,{from:i,to:e}),!this.hasStart){this.config.url=e.url;return}var u=this.switchURL(e.url,W({seamless:o.seamless!==!1&&typeof MediaSource<"u"&&typeof MediaSource.isTypeSupported=="function"},e));u&&u.then?u.then(function(){n.emit(ct,{from:i,to:e})}):this.emit(ct,{from:i,to:e})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(Pe,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,i=y.NOT_ALLOW_AUTOPLAY,n=y.PLAYING,o=y.NO_START,u=y.PAUSED,l=y.REPLAY,f=y.ENTER,h=y.ENDED,d=y.ERROR,v=y.LOADING,g=[i,n,o,u,l,f,h,d,v];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,g.forEach(function(m){e.removeClass(m)}),this.addClass(y.NO_START),this.emit(et)}},{key:"reset",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;this.resetState();var o=this.plugins;if(o&&(i.map(function(l){e.deregister(l)}),n)){var u=Et();Object.keys(this.config).keys(function(l){e.config[l]!=="undefined"&&(l==="plugins"||l==="presets"||l==="el"||l==="id")&&(e.config[l]=u[l])})}}},{key:"destroy",value:function(){var e,i=this,n=this.innerContainer,o=this.root,u=this.media;if(!(!o||!u)){if(this.hasStart=!1,this._useAutoplay=!1,o.removeAttribute(ue),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),c.clearAllTimers(this),this.emit(Ut),(e=ee)===null||e===void 0||e.remove(this),G.destroy(this),Wt(this),S(b(r.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),n)for(var l=n.children,f=0;f<l.length;f++)n.removeChild(l[f]);!n&&u instanceof window.Node&&o.contains(u)&&o.removeChild(u),["topBar","leftBar","rightBar","innerContainer"].map(function(d){i[d]&&o.removeChild(i[d]),i[d]=null});var h=o.className.split(" ");h.length>0?o.className=h.filter(function(d){return d.indexOf("xgplayer")<0}).join(" "):o.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(d){i[d]=!1})}}},{key:"replay",value:function(){var e=this;this.removeClass(y.ENDED),this.currentTime=0,this.isSeeking=!1,le(this,"replay",function(){e.once(re,function(){var i=e.mediaPlay();i&&i.catch&&i.catch(function(n){console.log(n)})}),e.emit(zi),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass(y.ERROR),this.addClass(y.LOADING),le(this,"retry",function(){var i=e.currentTime,n=e.config.url,o=c.isMSE(e.media)?{url:n}:e._preProcessUrl(n);e.src=o.url,!e.config.isLive&&(e.currentTime=i),e.once(ce,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,i,n,o){e&&(o||(o=y.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=c.filterStyleFromText(e)),c.addClass(e,n),i&&i!==e&&!this._orgPCss&&(this._orgPCss=c.filterStyleFromText(i),c.addClass(i,o),i.setAttribute(ue,this.playerId)))}},{key:"recoverFullStyle",value:function(e,i,n,o){o||(o=y.PARENT_FULLSCREEN),this._orgCss&&(c.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),c.removeClass(e,n),i&&i!==e&&this._orgPCss&&(c.setStyleFromCsstext(i,this._orgPCss),this._orgPCss="",c.removeClass(i,o),i.removeAttribute(ue))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,i=this.root,n=this.media;(e==="video"||e==="media")&&(e=this[e]),e||(e=i),this._fullScreenOffset={top:c.scrollTop(),left:c.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get";var o=c.getFullScreenEl();if(o===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var u=0;u<gt.length;u++){var l=gt[u];if(e[l]){var f=l==="webkitRequestFullscreen"?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[l]();return f&&f.then?f:Promise.resolve()}}return n.fullscreenEnabled||n.webkitSupportsFullscreen?(n.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch{return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),!(!this._fullscreenEl&&!c.getFullScreenEl())){this.root;var i=this.media;this._fullActionFrom="exit";try{for(var n=0;n<vt.length;n++){var o=vt[n];if(document[o]){var u=document[o]();return u&&u.then?u:Promise.resolve()}}return i&&i.webkitSupportsFullscreen?(i.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch{return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var i=e?"".concat(y.INNER_FULLSCREEN," ").concat(y.CSS_FULLSCREEN):y.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,i);var n=this.config.fullscreen,o=n===void 0?{}:n,u=o.useCssFullscreen===!0||typeof o.useCssFullscreen=="function"&&o.useCssFullscreen();u&&(this.fullscreen=!0,this.emit(ne,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(lt,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(y.INNER_FULLSCREEN," ").concat(y.CSS_FULLSCREEN):y.CSS_FULLSCREEN;if(!this.fullscreen)this.recoverFullStyle(this.root,this._cssfullscreenEl,e);else{var i=this.config.fullscreen,n=i===void 0?{}:i,o=n.useCssFullscreen===!0||typeof n.useCssFullscreen=="function"&&n.useCssFullscreen();o?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(ne,!1)):this.removeClass(e)}this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(lt,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var i=e?"".concat(y.INNER_FULLSCREEN," ").concat(y.ROTATE_FULLSCREEN):y.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,i,y.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style"),this.root.style.width="".concat(window.innerHeight,"px"),this.emit(ne,!0)}},{key:"exitRotateFullscreen",value:function(e){var i=this._fullscreenEl!==this.root?"".concat(y.INNER_FULLSCREEN," ").concat(y.ROTATE_FULLSCREEN):y.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,i,y.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(ne,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(e);return}this.emit(Ft,W({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(e);return}this._clearUserTimer(),this.emit(Wi,W({paused:this.paused,ended:this.ended},e))}},{key:"onFocus",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!0,delay:3e3},n=this.innerStates;if(this.isActive=!0,this.removeClass(y.INACTIVE),this._clearUserTimer(),i.isLock!==void 0&&(n.isActiveLocked=i.isLock),i.autoHide===!1||i.isLock===!0||n.isActiveLocked){this._clearUserTimer();return}var o=i&&i.delay?i.delay:this.config.inactive;this.userTimer=c.setTimeout(this,function(){e.userTimer=null,e.blur()},o)}},{key:"onBlur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=e.ignorePaused,n=i===void 0?!1:i;if(!this.innerStates.isActiveLocked){var o=this.config.closePauseVideoFocus;this.isActive=!1,(n||o||!this.paused&&!this.ended)&&this.addClass(y.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(y.ENTER),this.removeClass(y.ERROR),this.removeClass(y.LOADING),this.isCanplay=!0,this.waitTimer&&c.clearTimeout(this,this.waitTimer)}},{key:"onLoadeddata",value:function(){this.isError=!1,this.isSeeking=!1,this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime,this.__startTime=-1)}},{key:"onLoadstart",value:function(){this.removeClass(y.ERROR),this.isCanplay=!1}},{key:"onPlay",value:function(){this.state===A.ENDED&&this.setState(A.RUNNING),this.removeClass(y.PAUSED),this.ended&&this.removeClass(y.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(y.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this._clearUserTimer(),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(y.ENDED),this.setState(A.ENDED)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(y.NOT_ALLOW_AUTOPLAY),this.removeClass(y.NO_START),this.removeClass(y.ENTER),this.removeClass(y.LOADING),this.addClass(y.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(y.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&c.clearTimeout(this,this.waitTimer),this.removeClass(y.LOADING),this.removeClass(y.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&c.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=c.setTimeout(this,function(){e.addClass(y.LOADING),e.emit(Yi),c.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1;var i=y.NO_START,n=y.PAUSED,o=y.ENDED,u=y.ERROR,l=y.REPLAY,f=y.LOADING,h=[i,n,o,u,l,f];h.forEach(function(d){e.removeClass(d)}),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass(y.LOADING))&&this.media.readyState>2&&(this.removeClass(y.LOADING),c.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state===A.NOTALLOW&&this.duration&&(this.setState(A.RUNNING),this.emit(me)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){c.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,i,n){if(!(!this.media||!i||!e)){var o=c.typeOf(e)==="String"?e:e.type||"";n.props&&c.typeOf(n.props)!=="Array"&&(n.props=[n.props]),this.emit(ht,W({eventType:o,action:i,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},n))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var i=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=i,this._accPlayed.t=0,(e==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{startDiff:0,endDiff:0},n=i||{},o=n.startDiff,u=o===void 0?0:o,l=n.endDiff,f=l===void 0?0:l,h=this.media.buffered;if(!h||h.length===0||!this.duration)return!0;for(var d=e||this.media.currentTime||.2,v=h.length,g=0;g<v;g++)if(h.start(g)+u<=d&&h.end(g)-f>d)return!0;return!1}},{key:"resizePosition",value:function(){var e=this.videoPos,i=e.vy,n=e.vx,o=e.h,u=e.w,l=this.videoPos.rotate;if(!(l<0&&o<0&&u<0)){var f=this.videoPos._pi;if(!f&&this.media.videoHeight&&(f=this.media.videoWidth/this.media.videoHeight*100),!!f){this.videoPos.pi=f,l=l<0?0:l;var h={rotate:l},d=0,v=0,g=1,m=Math.abs(l/90),p=this.root,T=this.innerContainer,E=p.offsetWidth,C=T?T.offsetHeight:p.offsetHeight,N=C,P=E;if(m%2===0)g=o>0?100/o:u>0?100/u:1,h.scale=g,d=i>0?(100-o)/2-i:0,h.y=m===2?0-d:d,v=n>0?(100-u)/2-n:0,h.x=m===2?0-v:v,this.media.style.width="".concat(P,"px"),this.media.style.height="".concat(N,"px");else if(m%2===1){P=C,N=E;var F=C-E;v=-F/2/P*100,h.x=m===3?v+i/2:v-i/2,d=F/2/N*100,h.y=m===3?d+n/2:d-n/2,h.scale=g,this.media.style.width="".concat(P,"px"),this.media.style.height="".concat(N,"px")}var I=c.getTransformStyle(h,this.media.style.transform||this.media.style.webkitTransform);this.media.style.transform=I,this.media.style.webkitTransform=I}}}},{key:"position",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(!(!this.media||!e||!e.h)){var i=this.videoPos;i.h=e.h*100||0,i.w=e.w*100||0,i.vx=e.x*100||0,i.vy=e.y*100||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var i=this;e&&Object.keys(e).map(function(n){if(n!=="plugins"){i.config[n]=e[n];var o=i.plugins[n.toLowerCase()];o&&c.typeOf(o.setConfig)==="Function"&&o.setConfig(e[n])}})}},{key:"playNext",value:function(e){var i=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,le(this,"playnext",function(){i.start(),i.emit(qe,e)})}},{key:"resize",value:function(){var e=this;if(this.media){var i=this.root.getBoundingClientRect();this.sizeInfo.width=i.width,this.sizeInfo.height=i.height,this.sizeInfo.left=i.left,this.sizeInfo.top=i.top;var n=this.media,o=n.videoWidth,u=n.videoHeight,l=this.config,f=l.fitVideoSize,h=l.videoFillMode;if((h==="fill"||h==="cover"||h==="contain")&&this.setAttribute("data-xgfill",h),!(!u||!o)){this._videoHeight=u,this._videoWidth=o;var d=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,v=i.width,g=i.height-d,m=parseInt(o/u*1e3,10),p=parseInt(v/g*1e3,10),T=v,E=g,C={};f==="auto"&&p>m||f==="fixWidth"?(E=v/m*1e3,this.config.fluid?C.paddingTop="".concat(E*100/T,"%"):C.height="".concat(E+d,"px")):(f==="auto"&&p<m||f==="fixHeight")&&(T=m*g/1e3,C.width="".concat(T,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(C).forEach(function(P){e.root.style[P]=C[P]}),(h==="fillHeight"&&p<m||h==="fillWidth"&&p>m)&&this.setAttribute("data-xgfill","cover");var N={videoScale:m,vWidth:T,vHeight:E,cWidth:T,cHeight:E+d};this.resizePosition(),this.emit(_e,N)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.media.updateObjectPosition){this.media.updateObjectPosition(e,i);return}this.media.style.objectPosition="".concat(e*100,"% ").concat(i*100,"%")}},{key:"setState",value:function(e){L.logInfo("setState","state from:".concat(kt[this.state]," to:").concat(kt[e])),this._state=e}},{key:"_preProcessUrl",value:function(e,i){var n=this.config,o=n.preProcessUrl,u=n.preProcessUrlOptions,l=Object.assign({},u,i);return!c.isBlob(e)&&typeof o=="function"?o(e,l):{url:e}}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){typeof e=="boolean"&&(this._hasStart=e,e===!1&&this.setState(A.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===A.RUNNING||this._state===A.ENDED},set:function(e){e?this.setState(A.RUNNING):this._state>=A.RUNNING&&this.setState(A.ATTACHED)}},{key:"definitionList",get:function(){return!this.config||!this.config.definition?[]:this.config.definition.list||[]},set:function(e){var i=this,n=this.config.definition,o=null,u=null;n.list=e,this.emit("resourceReady",e),e.forEach(function(l){var f;((f=i.curDefinition)===null||f===void 0?void 0:f.definition)===l.definition&&(o=l),n.defaultDefinition===l.definition&&(u=l)}),!u&&e.length>0&&(u=e[0]),o?this.changeDefinition(o):u&&this.changeDefinition(u)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var i=this.media.getVideoPlaybackQuality();return e.dropped=i.droppedVideoFrames||0,e.total=i.totalVideoFrames||0,e.corrupted=i.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){var i=Ie.langKeys.filter(function(n){return n===e});if(i.length===0&&e!=="zh"){console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(Ie.langKeys.join(),"] "));return}this.config.lang=e,G.setLang(e,this)}},{key:"i18n",get:function(){var e=this.config.lang;return e==="zh"&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return Xe}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return S(b(r.prototype),"readyState",this)}},{key:"error",get:function(){var e=S(b(r.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){return S(b(r.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var e=this._accPlayed,i=e.acc,n=e.t;return n?new Date().getTime()-n+i:i}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){e=c.convertDeg(e),!(e%90!==0||e===this.videoPos.rotate)&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return bt},set:function(e){bt=e}},{key:"realTimeSpeed",get:function(){return Tt},set:function(e){Tt=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime||0},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration||0},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,i){return Ae.call.apply(Ae,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,i){return Le.call.apply(Le,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,i){return Oe.call.apply(Oe,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,i,n){for(var o=arguments.length,u=new Array(o>3?o-3:0),l=3;l<o;l++)u[l-3]=arguments[l];return pt.call.apply(pt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,i,n){for(var o=arguments.length,u=new Array(o>3?o-3:0),l=3;l<o;l++)u[l-3]=arguments[l];return mt.call.apply(mt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,i){var n;typeof i=="boolean"&&i!==this.muted&&(this.addInnerOP("volumechange"),c.typeOf(i)===Boolean&&(this.muted=i)),(n=ee)===null||n===void 0||n.setActive(this.playerId,e)}}],[{key:"debugger",get:function(){return L.config.debug},set:function(e){L.config.debug=e}},{key:"instManager",get:function(){return ee},set:function(e){ee=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return(e=ee)===null||e===void 0?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,i){var n;(n=ee)===null||n===void 0||n.setActive(e,i)}},{key:"isHevcSupported",value:function(){return M.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return M.probeConfigSupported(e)}},{key:"install",value:function(e,i){r.plugins||(r.plugins={}),r.plugins[e]||(r.plugins[e]=i)}},{key:"use",value:function(e,i){r.plugins||(r.plugins={}),r.plugins[e]=i}}]),r}(tn);k(Se,"defaultPreset",null);k(Se,"XgVideoProxy",null);Se.instManager=bn.getInstance();function j(){return new Date().getTime()}var te={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd"},xn=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"_onTimeupdate",function(){t._state.isTimeUpdate=!0,t._state.autoplayStart&&(L.logInfo("[xgLogger]".concat(t.player.playerId," _onTimeupdate")),t._sendFF("onTimeupdate"))}),k(_(t),"_onAutoplayStart",function(){L.logInfo("[xgLogger]".concat(t.player.playerId," _onAutoplayStart")),t._state.autoplayStart=!0,t.vt&&t._sendFF("onAutoplayStart")}),k(_(t),"_onReset",function(){t._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1},t.vt=0,t.pt=0,t.fvt=0,t.newPointTime=j(),t.loadedCostTime=0,t.startCostTime=0,t._isSeeking=!1,t.seekingStart=0,t.waitingStart=0,t.fixedWaitingStart=0,t._isWaiting=!1,t._waitTimer&&c.clearTimeout(_(t),t._waitTimer),t._waittTimer&&c.clearTimeout(_(t),t._waittTimer),t._waitTimer=null,t._waittTimer=null,t._waitType=0}),k(_(t),"_onSeeking",function(){t.seekingStart||(t.suspendWaitingStatus("seek"),t.seekingStart=j(),t.emitLog(te.SEEK_START,{start:j()}))}),k(_(t),"_onSeeked",function(){t.suspendSeekingStatus("seeked")}),k(_(t),"_onWaitingLoadStart",function(){t._isWaiting||t.vt||(t._isWaiting=!0,t.waitingStart=j(),t.fixedWaitingStart=j(),t._waitType=1,t.emitLog(te.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:1,endType:"loadstart"}))}),k(_(t),"_onWaiting",function(){t._isWaiting||!t.vt||(t._isWaiting=!0,t.vt?t.seekingStart?t._waitType=2:t._waitType=0:t._waitType=1,t.fixedWaitingStart=j(),t._waitTimer=c.setTimeout(_(t),function(){t._isWaiting&&(t.waitingStart=j(),c.clearTimeout(_(t),t._waitTimer),t._waitTimer=null,t._startWaitTimeout(),t.emitLog(te.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:t._waitType,endType:t._waitType===2?"seek":"playing"}))},200))}),k(_(t),"_onError",function(){t.suspendSeekingStatus("error"),t.suspendWaitingStatus("error")}),k(_(t),"_onPlaying",function(){t._isWaiting&&t.suspendWaitingStatus("playing")}),t}return x(r,[{key:"afterCreate",value:function(){var e=this;this._onReset(),this._waitType="firstFrame",this._initOnceEvents(),this.newPointTime=j(),this.loadedCostTime=0,this.startCostTime=0,this.on(ji,function(){var i=e._state,n=i.autoplayStart,o=i.isFFSend;e.startCostTime=j()-e.newPointTime,L.logInfo("[xgLogger]".concat(e.player.playerId," LOAD_START"),"autoplayStart:".concat(n," isFFSend:").concat(o," startCostTime:").concat(e.startCostTime," newPointTime").concat(e.newPointTime)),!o&&(!i.isLs&&e.emitLog(te.LOAD_START,{}),i.isLs=!0,i.isTimeUpdate=!1,i.isFFLoading=!0,e.pt=j(),e.vt=0,e.fvt=0,e._initOnceEvents(),e._onWaitingLoadStart())}),this.on(Pe,function(){e.vt=j(),e.fvt=e.vt-e.pt,e.loadedCostTime=e.vt-e.newPointTime;var i=e._state,n=i.isTimeUpdate,o=i.isFFSend,u=i.autoplayStart;L.logInfo("[xgLogger]".concat(e.player.playerId," LOADED_DATA"),"fvt:".concat(e.fvt," isTimeUpdate:").concat(e._state.isTimeUpdate," loadedCostTime:").concat(e.loadedCostTime)),(n||u)&&e._sendFF("loadedData"),o||e.emitLog(te.LOADED_DATA,{}),e.suspendWaitingStatus("loadeddata")}),this.on(Hi,this._onSeeking),this.on(re,this._onSeeked),this.on(Ut,function(){e.endState("destroy")}),this.on(Je,function(){e.endState("urlChange"),L.logInfo("[xgLogger]".concat(e.player.playerId," URL_CHANGE")),e._state.isFFSend&&e._onReset()}),this.on([Mi,ce],this._onPlaying),this.on(Nt,this._onWaiting),this.on(De,this._onError),this.on(et,function(){L.logInfo("[xgLogger]".concat(e.player.playerId," RESET")),e.endState("reset"),e._initOnceEvents(),e._onReset()})}},{key:"_initOnceEvents",value:function(){this.off(me,this._onAutoplayStart),this.off(se,this._onTimeupdate),this.once(me,this._onAutoplayStart),this.once(se,this._onTimeupdate)}},{key:"_sendFF",value:function(e){this.s=j();var i=this._state,n=i.isFFLoading,o=i.isFFSend;L.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(e," fvt:").concat(this.fvt," isFFLoading:").concat(n," !isFFSend:").concat(!o)),this.vt>0&&n&&!o&&(L.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),e),this._state.isFFLoading=!1,this._state.isFFSend=!0,this.emitLog(te.FIRST_FRAME,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime}))}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&c.clearTimeout(this,this._waittTimer),this._waittTimer=c.setTimeout(this,function(){e.suspendWaitingStatus("timeout"),c.clearTimeout(e,e._waittTimer),e._waittTimer=null},this.config.waitTimeout)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e),this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var i=j(),n=i-this.seekingStart;this.seekingStart=0,this.emitLog(te.SEEK_END,{end:i,costTime:n,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer&&(c.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(c.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,!!this.waitingStart){var i=j(),n=i-this.waitingStart,o=i-this.fixedWaitingStart,u=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0,this.emitLog(te.WAIT_END,{fixedCostTime:o>u?u:o,costTime:n>u?u:n,type:e==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":e})}}},{key:"emitLog",value:function(e,i){var n=this.player;this.emit(qi,W({t:j(),host:c.getHostFromUrl(n.currentSrc),vtype:n.vtype,eventType:e,currentTime:this.player.currentTime,readyState:n.video.readyState,networkState:n.video.networkState},i))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]),r}(B);function In(){return new DOMParser().parseFromString(`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">
  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`,"image/svg+xml").firstChild}var Pn=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"registerIcons",value:function(){return{replay:In}}},{key:"afterCreate",value:function(){var e=this;B.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",function(){e.player.replay()},{pre:function(n){n.preventDefault(),n.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(we,function(){if(e.playerConfig.loop||c.addClass(e.player.root,"replay"),!e.config.disable){e.show();var i=e.root.querySelector("path");if(i){var n=window.getComputedStyle(i).getPropertyValue("transform");if(typeof n=="string"&&n.indexOf("none")>-1)return null;i.setAttribute("transform",n)}}}),this.on(ye,function(){e.hide()})}},{key:"handleReplay",value:function(e){e.preventDefault(),e.stopPropagation(),this.player.replay(),c.removeClass(this.player.root,"replay")}},{key:"show",value:function(e){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return`<xg-replay class="xgplayer-replay">
      <xg-replay-txt class="xgplayer-replay-txt" lang-key="`.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,`</xg-replay-txt>
    </xg-replay>`)}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),r}(B),An=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(e){this.config.isEndedShow=e}},{key:"hide",value:function(){c.addClass(this.root,"hide")}},{key:"show",value:function(e){c.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(e){typeof e.player.config.poster=="string"&&(e.config.poster=e.player.config.poster)}},{key:"afterCreate",value:function(){var e=this;this.on(we,function(){e.isEndedShow&&c.removeClass(e.root,"hide")}),this.config.hideCanplay?(this.once(se,function(){e.onTimeUpdate()}),this.on(Je,function(){c.removeClass(e.root,"hide"),c.addClass(e.root,"xg-showplay"),e.once(se,function(){e.onTimeUpdate()})})):this.on(ye,function(){c.addClass(e.root,"hide")})}},{key:"setConfig",value:function(e){var i=this;Object.keys(e).forEach(function(o){i.config[o]=e[o]});var n=this.config.poster;this.update(n)}},{key:"onTimeUpdate",value:function(){var e=this;this.player.currentTime?c.removeClass(this.root,"xg-showplay"):this.once(se,function(){e.onTimeUpdate()})}},{key:"update",value:function(e){e&&(this.config.poster=e,this.root.style.backgroundImage="url(".concat(e,")"))}},{key:"getBgSize",value:function(e){var i="";switch(e){case"cover":i="cover";break;case"contain":i="contain";break;case"fixHeight":i="auto 100%";break;default:i=""}return i?"background-size: ".concat(i,";"):""}},{key:"render",value:function(){var e=this.config,i=e.poster,n=e.hideCanplay,o=e.fillMode,u=e.notHidden,l=this.getBgSize(o),f=i?"background-image:url(".concat(i,");").concat(l):l,h=u?"xg-not-hidden":n?"xg-showplay":"";return'<xg-poster class="xgplayer-poster '.concat(h,'" style="').concat(f,`">
    </xg-poster>`)}}],[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,notHidden:!1,poster:"",fillMode:"fixWidth"}}}]),r}(B);function zt(){return new DOMParser().parseFromString(`<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`,"image/svg+xml").firstChild}function Yt(){return new DOMParser().parseFromString(`<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`,"image/svg+xml").firstChild}var Q={};function Ln(a,s){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{start:null,end:null};return Q[a]&&window.clearTimeout(Q[a].id),Q[a]={},r.start&&r.start(),Q[a].id=window.setTimeout(function(){r.end&&r.end(),window.clearTimeout(Q[a].id),delete Q[a]},s),Q[a].id}function St(a){if(a){window.clearTimeout(a);return}Object.keys(Q).map(function(s){window.clearTimeout(Q[s].id),delete Q[s]})}var On=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),k(_(e),"onPlayerReset",function(){e.autoPlayStart=!1;var i=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),c.removeClass(e.root,i),e.show()}),k(_(e),"onAutoplayStart",function(){if(!e.autoPlayStart){var i=e.config.mode==="auto"?"auto-hide":"hide";c.addClass(e.root,i),e.autoPlayStart=!0,e.onPlayPause("play")}}),e.autoPlayStart=!1,e}return x(r,[{key:"afterCreate",value:function(){var e=this,i=this.player,n=this.playerConfig;this.initIcons(),this.once(Mt,function(){n&&(n.lang&&n.lang==="en"?c.addClass(i.root,"lang-is-en"):n.lang==="jp"&&c.addClass(i.root,"lang-is-jp"))}),this.on(me,this.onAutoplayStart),n.autoplay||this.show(),this.on(Ht,function(){var o=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),c.removeClass(e.root,o),e.show()}),this.on(ye,function(){e.onPlayPause("play")}),this.on(Dt,function(){e.onPlayPause("pause")}),this.on(et,function(){e.onPlayerReset()}),this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(u){u.cancelable&&u.preventDefault(),u.stopPropagation();var l=e.player.paused;e.emitUserAction(u,"switch_play_pause",{props:"paused",from:l,to:!l})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:zt,class:"xg-icon-play"},startPause:{icon:Yt,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild("xg-start-inner",e.startPlay),this.appendChild("xg-start-inner",e.startPause)}},{key:"hide",value:function(){c.addClass(this.root,"hide")}},{key:"show",value:function(e){c.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){c.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){c.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(e){e?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(e){var i=this;this._animateId=Ln("pauseplay",400,{start:function(){c.addClass(i.root,"interact"),i.show(),i.switchStatus(!0)},end:function(){c.removeClass(i.root,"interact"),!e&&i.hide(),i._animateId=null}})}},{key:"endAnimate",value:function(){c.removeClass(this.root,"interact"),St(this._animateId),this._animateId=null}},{key:"switchPausePlay",value:function(e){var i=this.player;if(e.cancelable&&e.preventDefault(),e.stopPropagation(),!(i.state<A.READY)){var n=this.player.paused;!n&&i.state===A.RUNNING?i.pause():i.play()}}},{key:"onPlayPause",value:function(e){var i=this.config,n=this.player;if(!(!n||n.state<A.RUNNING||!this.autoPlayStart)){if(i.mode==="show"){this.switchStatus(),this.show();return}if(i.mode==="auto"){this.switchStatus();return}if(i.isShowPause&&n.paused&&!n.ended||i.isShowEnd&&n.ended){this.switchStatus(),this.show(),this.endAnimate();return}if(i.disableAnimate){this.switchStatus(),this.hide();return}if(e==="play")this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||n.ended)return;this.animate()}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),St(this._animateId)}},{key:"render",value:function(){var e=this.playerConfig.autoplay?this.config.mode==="auto"?"auto-hide":"hide":"";return`
    <xg-start class="xgplayer-start `.concat(e,`">
    <xg-start-inner></xg-start-inner>
    </xg-start>`)}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),r}(B),Rn=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"render",value:function(){var e=this.config.innerHtml,i=c.createDom("xg-enter","",{},"xgplayer-enter");if(e&&e instanceof window.HTMLElement)i.appendChild(e);else if(e&&typeof e=="string")i.innerHTML=e;else{for(var n="",o=1;o<=12;o++)n+='<div class="xgplayer-enter-bar'.concat(o,'"></div>');i.innerHTML='<div class="xgplayer-enter-spinner">'.concat(n,"</div>")}return i}}],[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}]),r}(B);function Ce(a,s,r){try{return' <div class="xg-tips '.concat(r?"hide":" ",'" lang-key="').concat(a.i18nKeys[s],`">
    `).concat(a.i18n[s],`
    </div>`)}catch{return'<div class="xg-tips hide"></div>'}}var ie={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},Dn={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},Nn={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function wt(a){return a&&a.length>0?a[a.length-1]:null}function Fn(){return{pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0}}var Mn=function(){function a(s){var r=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{eventType:"touch"};w(this,a),k(this,"onTouchStart",function(e){var i=r._pos,n=r.root,o=wt(e.touches);i.x=o?parseInt(o.pageX,10):e.pageX,i.y=o?parseInt(o.pageX,10):e.pageX,i.start=!0,r.__setPress(e),n.addEventListener(r.events.end,r.onTouchEnd),n.addEventListener(r.events.cancel,r.onTouchCancel),n.addEventListener(r.events.move,r.onTouchMove),r.trigger(ie.TOUCH_START,e)}),k(this,"onTouchCancel",function(e){r.onTouchEnd(e)}),k(this,"onTouchEnd",function(e){var i=r._pos,n=r.root;r.__clearPress(),n.removeEventListener(r.events.cancel,r.onTouchCancel),n.removeEventListener(r.events.end,r.onTouchEnd),n.removeEventListener(r.events.move,r.onTouchMove),e.moving=i.moving,e.press=i.press,i.press&&r.trigger(ie.PRESS_END,e),r.trigger(ie.TOUCH_END,e),!i.press&&!i.moving&&r.__setDb(e),i.press=!1,i.start=!1,i.moving=!1}),k(this,"onTouchMove",function(e){var i=r._pos,n=r.config,o=wt(e.touches),u=o?parseInt(o.pageX,10):e.pageX,l=o?parseInt(o.pageY,10):e.pageX,f=u-i.x,h=l-i.y;Math.abs(h)<n.miniStep&&Math.abs(f)<n.miniStep||(r.__clearPress(),i.press&&r.trigger(ie.PRESS_END,e),i.press=!1,i.moving=!0,r.trigger(ie.TOUCH_MOVE,e))}),this._pos={moving:!1,start:!1,x:0,y:0},this.config=Fn(),Object.keys(t).map(function(e){r.config[e]=t[e]}),this.root=s,this.events=t.eventType==="mouse"?Nn:Dn,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return x(a,[{key:"_initEvent",value:function(){this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(r){var t=this,e=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){t.trigger(ie.PRESS,r),t._pos.press=!0,t.__clearPress()},e.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(r){var t=this,e=this.config;if(this.dbIntrvalId){this.__clearDb(),this.trigger(ie.DOUBlE_CLICK,r);return}this.dbIntrvalId=setTimeout(function(){t.__clearDb(),!t._pos.start&&!t._pos.press&&!t._pos.moving&&t.trigger(ie.CLICK,r)},e.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(r,t){this.__handlers[r]||(this.__handlers[r]=[]),this.__handlers[r].push(t)}},{key:"off",value:function(r,t){if(this.__handlers[r]){for(var e=this.__handlers[r],i=-1,n=0;n<e.length;n++)if(e[n]===t){i=n;break}i>=0&&this.__handlers[r].splice(i,1)}}},{key:"trigger",value:function(r,t){this.__handlers[r]&&this.__handlers[r].map(function(e){try{e(t)}catch(i){console.error("trigger>>:".concat(r),i)}})}},{key:"destroy",value:function(){var r=this,t={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(t).forEach(function(e){r.root.removeEventListener(e,r[t[e]])})}}]),a}();function Hn(){return new DOMParser().parseFromString(`<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path opacity="0.54"
    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"
    fill="white" />
  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>
</svg>`,"image/svg+xml").firstChild}var ge={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate",LIGHT:""},Ve=["videoClick","videoDbClick"],Bn=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),k(_(e),"onTouchStart",function(i){var n=_(e),o=n.player,u=n.config,l=n.pos,f=n.playerConfig,h=e.getTouche(i);if(h&&!u.disableGesture&&e.duration>0&&!o.ended){l.isStart=!0,e.timer&&clearTimeout(e.timer),c.checkIsFunction(f.disableSwipeHandler)&&f.disableSwipeHandler(),e.find(".xg-dur").innerHTML=c.format(e.duration);var d=e.root.getBoundingClientRect();o.rotateDeg===90?(l.top=d.left,l.left=d.top,l.width=d.height,l.height=d.width):(l.top=d.top,l.left=d.left,l.width=d.width,l.height=d.height);var v=parseInt(h.pageX-l.left,10),g=parseInt(h.pageY-l.top,10);l.x=o.rotateDeg===90?g:v,l.y=o.rotateDeg===90?v:g,l.scopeL=u.scopeL*l.width,l.scopeR=(1-u.scopeR)*l.width,l.scopeM1=l.width*(1-u.scopeM)/2,l.scopeM2=l.width-l.scopeM1}}),k(_(e),"onTouchMove",function(i){var n=e.getTouche(i),o=_(e),u=o.pos,l=o.config,f=o.player;if(!(!n||l.disableGesture||!e.duration||!u.isStart)){var h=l.miniMoveStep,d=l.hideControlsActive,v=parseInt(n.pageX-u.left,10),g=parseInt(n.pageY-u.top,10),m=f.rotateDeg===90?g:v,p=f.rotateDeg===90?v:g;if(Math.abs(m-u.x)>h||Math.abs(p-u.y)>h){var T=m-u.x,E=p-u.y,C=u.scope;if(C===-1&&(C=e.checkScope(m,p,T,E,u),C===0&&(d?f.blur():f.focus({autoHide:!1}),!u.time&&(u.time=parseInt(f.currentTime*1e3,10)+e.timeOffset*1e3)),u.scope=C),C===-1||C>0&&!l.gestureY||C===0&&!l.gestureX)return;e.executeMove(T,E,C,u.width,u.height),u.x=m,u.y=p}}}),k(_(e),"onTouchEnd",function(i){var n=_(e),o=n.player,u=n.pos,l=n.playerConfig;if(setTimeout(function(){o.getPlugin("progress")&&o.getPlugin("progress").resetSeekState()},10),!!u.isStart){u.scope>-1&&i.cancelable&&i.preventDefault();var f=e.config,h=f.disableGesture,d=f.gestureX;!h&&d?e.endLastMove(u.scope):u.time=0,u.scope=-1,e.resetPos(),c.checkIsFunction(l.enableSwipeHandler)&&l.enableSwipeHandler(),e.changeAction(ge.AUTO)}}),k(_(e),"onRootTouchMove",function(i){e.config.disableGesture||!e.config.gestureX||e.checkIsRootTarget(i)&&(i.stopPropagation(),e.pos.isStart?e.onTouchMove(i):e.onTouchStart(i))}),k(_(e),"onRootTouchEnd",function(i){e.pos.scope>-1&&e.onTouchEnd(i)}),e.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},e.timer=null,e}return x(r,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:Hn,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var e=this;Ve.map(function(d){e.__hooks[d]=null});var i=this.playerConfig,n=this.config,o=this.player;i.closeVideoDblclick===!0&&(n.closedbClick=!0),this.resetPos(),c.isUndefined(i.disableGesture)||(n.disableGesture=!!i.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=c.createDom("xg-mask","",{},"xgmask"),o.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var u=this.domEventType==="mouse"?"mouse":"touch";this.touch=new Mn(this.root,{eventType:u,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(d){d.preventDefault()}),o.root.addEventListener("touchmove",this.onRootTouchMove,!0),o.root.addEventListener("touchend",this.onRootTouchEnd,!0),o.root.addEventListener("touchcancel",this.onRootTouchEnd,!0);var l=this.player.controls;l&&l.center&&(l.center.addEventListener("touchmove",this.onRootTouchMove,!0),l.center.addEventListener("touchend",this.onRootTouchEnd,!0),l.center.addEventListener("touchcancel",this.onRootTouchEnd,!0)),this.on(Ne,function(){var d=e.player,v=e.config;d.duration*1e3<v.moveDuration&&(v.moveDuration=d.duration*1e3)}),this.on([ce,we],function(){var d=e.pos,v=d.time,g=d.isStart;!g&&v>0&&(e.pos.time=0)});var f={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(f).map(function(d){e.touch.on(d,function(v){e[f[d]](v)})}),!n.disableActive){var h=o.plugins.progress;h&&(h.addCallBack("dragmove",function(d){e.activeSeekNote(d.currentTime,d.forward)}),["dragend","click"].forEach(function(d){h.addCallBack(d,function(){e.changeAction(ge.AUTO)})}))}}},{key:"registerThumbnail",value:function(){var e=this.player,i=e.plugins.thumbnail;if(i&&i.usable){this.thumbnail=i.createThumbnail(null,"mobile-thumbnail");var n=this.find(".time-preview");n.insertBefore(this.thumbnail,n.children[0])}}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},i=e.commonStyle,n=i.playedColor,o=i.progressColor,u=i.timePreviewStyle,l=i.curTimeColor,f=i.durationColor;if(n&&(this.find(".xg-curbar").style.backgroundColor=n),o&&(this.find(".xg-bar").style.backgroundColor=o),u){var h=this.find(".time-preview");Object.keys(u).forEach(function(g){h.style[g]=u[g]})}var d=l||n,v=f;d&&(this.find(".xg-cur").style.color=d),v&&(this.find(".xg-dur").style.color=v),this.config.disableTimeProgress&&c.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var e=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(i){e.pos[i]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(e){var i=this.player,n=this.root;n.setAttribute("data-xg-action",e);var o=i.plugins.start;o&&o.recover()}},{key:"getTouche",value:function(e){var i=this.player.rotateDeg,n=e.touches&&e.touches.length>0?e.touches[e.touches.length-1]:e;return i===0?{pageX:n.pageX,pageY:n.pageY}:{pageX:n.pageX,pageY:n.pageY}}},{key:"checkScope",value:function(e,i,n,o,u){var l=u.width,f=-1;if(e<0||e>l)return f;var h=Math.abs(o===0?n:n/o);return Math.abs(n)>0&&h>=1.73&&e>u.scopeM1&&e<u.scopeM2?f=0:(Math.abs(n)===0||h<=.57)&&(f=e<u.scopeL?1:e>u.scopeR?2:3),f}},{key:"executeMove",value:function(e,i,n,o,u){switch(n){case 0:this.updateTime(e/o*this.config.scopeM);break;case 1:this.updateBrightness(i/u);break;case 2:M.os.isIos||this.updateVolume(i/u);break}}},{key:"endLastMove",value:function(e){var i=this,n=this.pos,o=this.player,u=this.config,l=(n.time-this.timeOffset)/1e3;switch(e){case 0:o.seek(Number(l).toFixed(1)),u.hideControlsEnd?o.blur():o.focus(),this.timer=setTimeout(function(){i.pos.time=0},500);break}this.changeAction(ge.AUTO)}},{key:"checkIsRootTarget",value:function(e){var i=this.player.plugins||{};return i.progress&&i.progress.root.contains(e.target)?!1:i.start&&i.start.root.contains(e.target)||i.controls&&i.controls.root.contains(e.target)}},{key:"sendUseAction",value:function(e){var i=this.player.paused;this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:i,to:!i})}},{key:"clickHandler",value:function(e){var i=this.player,n=this.config,o=this.playerConfig;if(i.state<A.RUNNING){o.closeVideoClick||(this.sendUseAction(c.createEvent("click")),i.play());return}!n.closedbClick||o.closeVideoClick?i.isActive?i.blur():i.focus():o.closeVideoClick||((i.isActive||n.focusVideoClick)&&(this.sendUseAction(c.createEvent("click")),this.switchPlayPause()),i.focus())}},{key:"dbClickHandler",value:function(e){var i=this.config,n=this.player;!i.closedbClick&&n.state>=A.RUNNING&&(this.sendUseAction(c.createEvent("dblclick")),this.switchPlayPause())}},{key:"onClick",value:function(e){var i=this,n=this.player;le(this,Ve[0],function(o,u){i.clickHandler(u.e)},{e,paused:n.paused})}},{key:"onDbClick",value:function(e){var i=this,n=this.player;le(this,Ve[1],function(o,u){i.dbClickHandler(u.e)},{e,paused:n.paused})}},{key:"onPress",value:function(e){var i=this.pos,n=this.config,o=this.player;n.disablePress||(i.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:o.playbackRate,to:n.pressRate}),o.playbackRate=n.pressRate,this.changeAction(ge.PLAYBACK))}},{key:"onPressEnd",value:function(e){var i=this.pos,n=this.config,o=this.player;n.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:o.playbackRate,to:i.rate}),o.playbackRate=i.rate,i.rate=1,this.changeAction(ge.AUTO))}},{key:"updateTime",value:function(e){var i=this.player,n=this.config,o=this.player.duration;e=Number(e.toFixed(4));var u=parseInt(e*n.moveDuration,10)+this.timeOffset;u+=this.pos.time,u=u<0?0:u>o*1e3?o*1e3-200:u,i.getPlugin("time")&&i.getPlugin("time").updateTime(u/1e3),i.getPlugin("progress")&&i.getPlugin("progress").updatePercent(u/1e3/this.duration,!0),this.activeSeekNote(u/1e3,e>0),n.isTouchingSeek&&i.seek(Number((u-this.timeOffset)/1e3).toFixed(1)),this.pos.time=u}},{key:"updateVolume",value:function(e){this.player.rotateDeg&&(e=-e);var i=this.player,n=this.pos;if(e=parseInt(e*100,10),n.volume+=e,!(Math.abs(n.volume)<10)){var o=parseInt(i.volume*10,10)-parseInt(n.volume/10,10);o=o>10?10:o<1?0:o,i.volume=o/10,n.volume=0}}},{key:"updateBrightness",value:function(e){this.player.rotateDeg&&(e=-e);var i=this.pos,n=this.config,o=this.xgMask,u=i.light+.8*e;u=u>n.maxDarkness?n.maxDarkness:u<0?0:u,o&&(o.style.backgroundColor="rgba(0,0,0,".concat(u,")")),i.light=u}},{key:"activeSeekNote",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.player,o=this.config,u=!(this.duration!==1/0&&this.duration>0);if(!(!e||typeof e!="number"||u||o.disableActive)){e<0?e=0:e>n.duration&&(e=n.duration-.2),this.changeAction(ge.SEEKING);var l=n.plugins.start;l&&l.focusHide(),this.find(".xg-dur").innerHTML=c.format(this.duration),this.find(".xg-cur").innerHTML=c.format(e),this.find(".xg-curbar").style.width="".concat(e/this.duration*100,"%"),i?c.removeClass(this.find(".xg-seek-show"),"xg-back"):c.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(e)}}},{key:"updateThumbnails",value:function(e){var i=this.player,n=i.plugins.thumbnail;n&&n.usable&&this.thumbnail&&n.update(this.thumbnail,e,160,90)}},{key:"switchPlayPause",value:function(){var e=this.player;if(e.state<A.ATTACHED)return!1;e.ended||(e.paused?e.play():e.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var e=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,e.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,e.root.removeEventListener("touchmove",this.onRootTouchMove,!0),e.root.removeEventListener("touchend",this.onRootTouchEnd,!0),e.root.removeEventListener("touchcancel",this.onRootTouchEnd,!0);var i=this.player.controls;i&&i.center&&(i.center.removeEventListener("touchmove",this.onRootTouchMove,!0),i.center.removeEventListener("touchend",this.onRootTouchEnd,!0),i.center.removeEventListener("touchcancel",this.onRootTouchEnd,!0))}},{key:"render",value:function(){var e=this.config.gradient!=="normal"?"gradient ".concat(this.config.gradient):"gradient";return`
     <xg-trigger class="trigger">
     <div class="`.concat(e,`"></div>
        <div class="time-preview">
            <div class="xg-seek-show `).concat(this.config.disableSeekIcon?" hide-seek-icon":"",`">
              <i class="xg-seek-icon"></i>
              <span class="xg-cur">00:00</span>
              <span class="xg-separator">/</span>
              <span class="xg-dur">00:00</span>
            </div>
              <div class="xg-bar xg-timebar">
                <div class="xg-curbar"></div>
              </div>
        </div>
        <div class="xg-playbackrate xg-top-note">
            <span><i>`).concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,`</span>
        </div>
     </xg-trigger>
    `)}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:60*6*1e3,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),r}(B);function Un(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110">
  <path d="M100,50A50,50,0,1,1,50,0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"></path>
</svg>
`,"image/svg+xml").firstChild}var Gn=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"registerIcons",value:function(){return{loadingIcon:Un}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return`
    <xg-loading class="xgplayer-loading">
      <xg-loading-inner></xg-loading-inner>
    </xg-loading>`}}],[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:H.ROOT}}}]),r}(B),jn=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],Wn=function(){function a(s){w(this,a),this.fragments=s.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=s.actionCallback,this.fragConfig={fragFocusClass:s.fragFocusClass||"inner-focus-point",fragAutoFocus:!!s.fragAutoFocus,fragClass:s.fragClass||""},this.style=s.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return x(a,[{key:"updateDuration",value:function(r){var t=this;this.duration=r;var e=0,i=this.fragments;this.fragments=i.map(function(n){return n.start=parseInt(e,10),n.end=parseInt(e+n.percent*t.duration,10),n.duration=parseInt(n.percent*t.duration,10),e+=n.percent*t.duration,n})}},{key:"updateProgress",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},e=this.progressList,i=this.fragments;if(!(e.length<1)){var n=t.newIndex,o=t.curIndex,u=t.millisecond;n!==o&&e.map(function(h,d){d<n?h[r].style.width="100%":d>n&&(h[r].style.width=0)});var l=i[n],f=u===0?0:(u-l.start)/l.duration;e[n][r].style.width=f<0?0:"".concat(f*100,"%")}}},{key:"updateFocus",value:function(r){if(!(!this.fragConfig.fragAutoFocus||this.fragments.length<2)){if(!r){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var t={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(t),this.focusIndex=-1}return}var e=this.findIndex(r.currentTime*1e3,this.focusIndex);if(e>=0&&e!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(e);var i={index:e,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=e,this._callBack&&this._callBack(i)}}}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(t*1e3,10)!==this.duration){if(!t&&t!==0)return;this.updateDuration(parseInt(t*1e3,10))}var e=this.playedIndex,i=this.cachedIndex;if(c.typeOf(r.played)!=="Undefined"){var n=this.findIndex(r.played*1e3,e);if(n<0)return;this.updateProgress("played",{newIndex:n,curIndex:e,millisecond:parseInt(r.played*1e3,10)}),this.playedIndex=n}if(c.typeOf(r.cached)!=="Undefined"){var o=this.findIndex(r.cached*1e3,i);if(o<0)return;this.updateProgress("cached",{newIndex:o,curIndex:i,millisecond:parseInt(r.cached*1e3,10)}),this.cachedIndex=o}}},{key:"findIndex",value:function(r,t){var e=this.fragments;if(!e||e.length===0)return-1;if(e.length===1)return 0;if(t>-1&&t<e.length&&r>e[t].start&&r<e[t].end)return t;if(r>e[e.length-1].start)return e.length-1;for(var i=0;i<e.length;i++)if(r>e[i].start&&r<=e[i].end){t=i;break}return t}},{key:"findHightLight",value:function(){for(var r=this.root.children,t=0;t<r.length;t++)if(c.hasClass(r[t],this.fragConfig.fragFocusClass))return{dom:r[t],pos:r[t].getBoundingClientRect()}}},{key:"findFragment",value:function(r){var t=this.root.children;return r<0||r>=t.length?null:{dom:t[r],pos:t[r].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var r=this.root.children,t=0;t<r.length;t++)c.removeClass(r[t],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(r){var t=this.root.children;if(r<t.length)return c.addClass(t[r],this.fragConfig.fragFocusClass),{dom:t[r],pos:t[r].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(r){var t=this;if(Object.keys(this.fragConfig).forEach(function(i){r[i]!==void 0&&(t.fragConfig[i]=r[i])}),r.fragments){if(this.fragments=r.fragments.length===0?[{percent:1}]:r.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var e=this.root.children;e.length>0;)this.root.removeChild(e[0]);this.render()}}},{key:"render",value:function(){var r=this,t=this.style.progressColor;if(this.root||(this.root=c.createDom("xg-inners","",{},"progress-list")),this.fragments){var e=this.fragConfig,i=e.fragClass,n=e.fragFocusClass;this.progressList=this.fragments.map(function(o){var u=c.createDom("xg-inner","",{style:t?"background:".concat(t,"; flex: ").concat(o.percent):"flex: ".concat(o.percent)},"".concat(o.isFocus?n:""," xgplayer-progress-inner ").concat(i));return r.root.appendChild(u),jn.forEach(function(l){u.appendChild(c.createDom(l.tag,"",{style:l.styleKey?"background: ".concat(r.style[l.styleKey],"; width:0;"):"width:0;"},l.className))}),{cached:u.children[0],played:u.children[1]}})}return this.root}}]),a}(),xt={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},Vn=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),k(_(e),"onMoveOnly",function(i,n){var o=_(e),u=o.pos,l=o.config,f=o.player,h=n;if(i){c.event(i);var d=c.getEventPos(i,f.zoom),v=f.rotateDeg===90?d.clientY:d.clientX;if(u.moving&&Math.abs(u.x-v)<l.miniMoveStep)return;u.moving=!0,u.x=v,h=e.computeTime(i,v)}e.triggerCallbacks("dragmove",h,i),e._updateInnerFocus(h)}),k(_(e),"onBodyClick",function(i){e.pos.isLocked&&(e.pos.isLocked=!1,i.preventDefault(),i.stopPropagation())}),k(_(e),"_mouseDownHandler",function(i,n){e._state.time=n.currentTime,e.updateWidth(n.currentTime,n.seekTime,n.percent,0),e._updateInnerFocus(n)}),k(_(e),"_mouseUpHandler",function(i,n){var o=_(e),u=o.pos;u.moving&&e.updateWidth(n.currentTime,n.seekTime,n.percent,2)}),k(_(e),"_mouseMoveHandler",function(i,n){var o=_(e),u=o._state,l=o.pos,f=o.config,h=o.player;u.time<n.currentTime?n.forward=!0:n.forward=!1,u.time=n.currentTime,l.isDown&&!l.moving&&(l.moving=!0,f.isPauseMoving&&h.pause(),e.triggerCallbacks("dragstart",n,i),e.emitUserAction("drag","dragstart",n)),e.updateWidth(n.currentTime,n.seekTime,n.percent,1),e.triggerCallbacks("dragmove",n,i),e._updateInnerFocus(n)}),k(_(e),"onMouseDown",function(i){var n=_(e),o=n._state,u=n.player,l=n.pos,f=n.config,h=n.playerConfig,d=c.getEventPos(i,u.zoom),v=u.rotateDeg===90?d.clientY:d.clientX;if(!(u.isMini||f.closeMoveSeek||!h.allowSeekAfterEnded&&u.ended)){if(!u.duration&&!u.isPlaying){u.play();return}i.stopPropagation(),e.focus(),c.checkIsFunction(h.disableSwipeHandler)&&h.disableSwipeHandler(),c.checkIsFunction(f.onMoveStart)&&f.onMoveStart(),c.event(i),l.x=v,l.isDown=!0,l.moving=!1,o.prePlayTime=u.currentTime,u.focus({autoHide:!1}),e.isProgressMoving=!0,c.addClass(e.progressBtn,"active");var g=e.computeTime(i,v);g.prePlayTime=o.prePlayTime,e._mouseDownHandlerHook(i,g);var m=i.type;return m==="touchstart"?(e.root.addEventListener("touchmove",e.onMouseMove),e.root.addEventListener("touchend",e.onMouseUp),e.root.addEventListener("touchcancel",e.onMouseUp)):(e.unbind("mousemove",e.onMoveOnly),document.addEventListener("mousemove",e.onMouseMove,!1),document.addEventListener("mouseup",e.onMouseUp,!1)),!0}}),k(_(e),"onMouseUp",function(i){var n=_(e),o=n.player,u=n.config,l=n.pos,f=n.playerConfig,h=n._state;i.stopPropagation(),i.preventDefault(),c.checkIsFunction(f.enableSwipeHandler)&&f.enableSwipeHandler(),c.checkIsFunction(u.onMoveEnd)&&u.onMoveEnd(),c.event(i),c.removeClass(e.progressBtn,"active");var d=e.computeTime(i,l.x);d.prePlayTime=h.prePlayTime,l.moving?(e.triggerCallbacks("dragend",d,i),e.emitUserAction("drag","dragend",d)):(e.triggerCallbacks("click",d,i),e.emitUserAction("click","click",d)),e._mouseUpHandlerHook(i,d),l.moving=!1,l.isDown=!1,l.x=0,l.y=0,l.isLocked=!0,h.prePlayTime=0,h.time=0;var v=i.type;v==="touchend"||v==="touchcancel"?(e.root.removeEventListener("touchmove",e.onMouseMove),e.root.removeEventListener("touchend",e.onMouseUp),e.root.removeEventListener("touchcancel",e.onMouseUp),e.blur()):(document.removeEventListener("mousemove",e.onMouseMove,!1),document.removeEventListener("mouseup",e.onMouseUp,!1),l.isEnter?f.isMobileSimulateMode!=="mobile"&&e.bind("mousemove",e.onMoveOnly):e.onMouseLeave(i)),c.setTimeout(_(e),function(){e.resetSeekState()},1),o.focus()}),k(_(e),"onMouseMove",function(i){var n=_(e),o=n._state,u=n.pos,l=n.player,f=n.config;c.checkTouchSupport()&&i.preventDefault(),c.event(i);var h=c.getEventPos(i,l.zoom),d=l.rotateDeg===90?h.clientY:h.clientX,v=Math.abs(u.x-d);if(!(u.moving&&v<f.miniMoveStep||!u.moving&&v<f.miniStartStep)){u.x=d;var g=e.computeTime(i,d);g.prePlayTime=o.prePlayTime,e._mouseMoveHandlerHook(i,g)}}),k(_(e),"onMouseOut",function(i){e.triggerCallbacks("mouseout",null,i)}),k(_(e),"onMouseOver",function(i){e.triggerCallbacks("mouseover",null,i)}),k(_(e),"onMouseEnter",function(i){var n=_(e),o=n.player,u=n.pos;if(!(u.isDown||u.isEnter||o.isMini||!o.config.allowSeekAfterEnded&&o.ended)){u.isEnter=!0,e.bind("mousemove",e.onMoveOnly),e.bind("mouseleave",e.onMouseLeave),c.event(i);var l=c.getEventPos(i,o.zoom),f=o.rotateDeg===90?l.clientY:l.clientX,h=e.computeTime(i,f);e.triggerCallbacks("mouseenter",h,i),e.focus()}}),k(_(e),"onMouseLeave",function(i){e.triggerCallbacks("mouseleave",null,i),e.unlock(),e._updateInnerFocus(null)}),k(_(e),"onVideoResize",function(){var i=e.pos,n=i.x,o=i.isDown,u=i.isEnter;if(u&&!o){var l=e.computeTime(null,n);e.onMoveOnly(null,l)}}),e.useable=!1,e.isProgressMoving=!1,e.__dragCallBacks=[],e._state={now:-1,direc:0,time:0,prePlayTime:-1},e._disableBlur=!1,e}return x(r,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"currentTime",get:function(){var e=this.player,i=e.offsetCurrentTime,n=e.currentTime;return i>=0?i:n+this.timeOffset}},{key:"changeState",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.useable=e}},{key:"show",value:function(e){this.root&&(this.root.style.display="flex")}},{key:"_initInner",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(!i||i.length===0)&&(i=[{percent:1}]);var o=W(W({fragments:i},n),{},{actionCallback:function(l){e.emitUserAction("fragment_focus","fragment_focus",l)}});this.innerList?this.innerList.reset(o):(this.innerList=new Wn(o),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(u){e[u]=e.innerList[u].bind(e.innerList)}))}},{key:"_updateInnerFocus",value:function(e){this.innerList&&this.innerList.updateFocus(e)}},{key:"afterCreate",value:function(){var e=this;if(!(this.config.disable||this.playerConfig.isLive)){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var i=this.config,n=i.fragFocusClass,o=i.fragAutoFocus,u=i.fragClass;this._initInner(this.config.fragments,{fragFocusClass:n,fragAutoFocus:o,fragClass:u,style:this.playerConfig.commonStyle||{}}),M.device==="mobile"&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(Ne,function(){e.onMouseLeave()}),this.on(se,function(){e.onTimeupdate()}),this.on(re,function(){e.onTimeupdate(),e.onCacheUpdate()}),this.on(Gi,function(){e.onCacheUpdate()}),this.on(we,function(){e.onCacheUpdate(!0),e.onTimeupdate(!0),e._state.now=0}),this.on(Fe,function(){e.onReset()}),this.on(_e,function(){e.onVideoResize()}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(e){var i=this,n=null;Object.keys(e).forEach(function(o){i.config[o]=e[o],o==="fragments"&&(n=e[o])}),n&&this._initInner(n,e)}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},i=e.commonStyle,n=i.sliderBtnStyle,o=this.progressBtn;n&&(typeof n=="string"?o.style.boxShadow=n:Y(n)==="object"&&Object.keys(n).map(function(u){o.style[u]=n[u]}))}},{key:"triggerCallbacks",value:function(e,i,n){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(o){if(o&&o.handler&&o.type===e)try{o.handler(i,n)}catch(u){console.error("[XGPLAYER][triggerCallbacks] ".concat(o," error"),u)}})}},{key:"addCallBack",value:function(e,i){i&&typeof i=="function"&&this.__dragCallBacks.push({type:e,handler:i})}},{key:"removeCallBack",value:function(e,i){var n=this.__dragCallBacks,o=-1;n.map(function(u,l){u&&u.type===e&&u.handler===i&&(o=l)}),o>-1&&n.splice(o,1)}},{key:"unlock",value:function(){var e=this.player,i=this.pos;if(i.isEnter=!1,i.isLocked=!1,!e.isMini){if(this.unbind("mousemove",this.onMoveOnly),i.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var e=this.player.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),(this.domEventType==="touch"||this.domEventType==="compatible")&&this.root.addEventListener("touchstart",this.onMouseDown),(this.domEventType==="mouse"||this.domEventType==="compatible")&&(this.bind("mousedown",this.onMouseDown),e.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),c.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),c.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,i,n,o){var u=this.config,l=this.player;if(!(u.isCloseClickSeek&&o===0)){var f=i=i>=l.duration?l.duration-u.endedDiff:Number(i).toFixed(1);this.updatePercent(n),this.updateTime(e),!(o===1&&(!u.isDragingSeek||l.config.mediaType==="audio"))&&(this._state.now=f,this._state.direc=f>l.currentTime?0:1,l.seek(f))}}},{key:"computeTime",value:function(e,i){var n=this.player,o=this.root.getBoundingClientRect(),u=o.width,l=o.height,f=o.top,h=o.left,d,v,g=i;n.rotateDeg===90?(d=l,v=f):(d=u,v=h);var m=g-v;m=m>d?d:m<0?0:m;var p=m/d;p=p<0?0:p>1?1:p;var T=parseInt(p*this.offsetDuration*1e3,10)/1e3,E=c.getCurrentTimeByOffset(T,n.timeSegments);return{percent:p,currentTime:T,seekTime:E,offset:m,width:d,left:v,e}}},{key:"updateTime",value:function(e){var i=this.player,n=this.duration;e>n?e=n:e<0&&(e=0);var o=i.plugins.time;o&&o.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,i){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(e*100,"%"),this.innerList.update({played:e*this.offsetDuration},this.offsetDuration);var n=this.player.plugins.miniprogress;n&&n.update({played:e*this.offsetDuration},this.offsetDuration)}}},{key:"onTimeupdate",value:function(e){var i=this.player,n=this._state,o=this.offsetDuration;if(!(i.isSeeking&&i.media.seeking||this.isProgressMoving||!i.hasStart)){if(n.now>-1){var u=parseInt(n.now*1e3,10)-parseInt(i.currentTime*1e3,10);if(n.direc===0&&u>300||n.direc===1&&u>-300){n.now=-1;return}else n.now=-1}var l=this.currentTime;l=c.adjustTimeByDuration(l,o,e),this.innerList.update({played:l},o),this.progressBtn.style.left="".concat(l/o*100,"%")}}},{key:"onCacheUpdate",value:function(e){var i=this.player,n=this.duration;if(i){var o=i.bufferedPoint.end;o=c.adjustTimeByDuration(o,n,e),this.innerList.update({cached:o},n)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0),this.progressBtn.style.left="0%"}},{key:"destroy",value:function(){var e=this.player;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var i=this.domEventType;(i==="touch"||i==="compatible")&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),this.root.removeEventListener("touchcancel",this.onMouseUp)),(i==="mouse"||i==="compatible")&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){var e=this.player.controls?this.player.controls.config.mode:"",i=e==="bottom"?"xgplayer-progress-bottom":"";return`
    <xg-progress class="xgplayer-progress `.concat(i,`">
      <xg-outer class="xgplayer-progress-outer">
        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
      </xg-outer>
    </xg-progress>
    `)}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:xt.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return xt}}]),r}(B),Ee=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"_onMouseenter",function(o){t.emit("icon_mouseenter",{pluginName:t.pluginName})}),k(_(t),"_onMouseLeave",function(o){t.emit("icon_mouseleave",{pluginName:t.pluginName})}),t}return x(r,[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave),this.config.disable&&this.disable()}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}]),r}(B),zn=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"afterCreate",value:function(){var e=this;S(b(r.prototype),"afterCreate",this).call(this);var i=this.player,n=this.config;n.disable||(this.initIcons(),this.btnClick=this.btnClick.bind(this),this.bind(["touchend","click"],this.btnClick),this.on([Dt,De,Fe],function(){e.animate(i.paused)}),this.on(ye,function(){e.animate(i.paused)}),this.animate(!0))}},{key:"registerIcons",value:function(){return{play:{icon:zt,class:"xg-icon-play"},pause:{icon:Yt,class:"xg-icon-pause"}}}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var i=this.player;return this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:i.paused,to:!i.paused}),i.ended?i.replay():i.paused?(i.play(),this.animate(!1)):(i.pause(),this.animate(!0)),!1}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.play),this.appendChild(".xgplayer-icon",e.pause)}},{key:"animate",value:function(e){if(this.player){var i=this.i18nKeys,n=this.find(".xg-tips");e?(this.setAttr("data-state","pause"),n&&this.changeLangTextKey(n,i.PLAY_TIPS)):(this.setAttr("data-state","play"),n&&this.changeLangTextKey(n,i.PAUSE_TIPS))}}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-play">
    <div class="xgplayer-icon">
    </div>
    `.concat(Ce(this,"PLAY_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_LEFT,index:0,disable:!1}}}]),r}(Ee);function Yn(){return new DOMParser().parseFromString(`<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>
    </g>
</svg>`,"image/svg+xml").firstChild}var Kn=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.onClick=function(i){i.preventDefault(),i.stopPropagation(),e.config.onClick(i)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:Yn,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(this.root,e.screenBack)}},{key:"show",value:function(){c.addClass(this.root,"show")}},{key:"hide",value:function(){c.removeClass(this.root,"show")}},{key:"render",value:function(){return`<xg-icon class="xgplayer-back">
    </xg-icon>`}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:H.ROOT_TOP,index:0}}}]),r}(B);function Xn(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`,"image/svg+xml").firstChild}function $n(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`,"image/svg+xml").firstChild}var qn=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"_onOrientationChange",function(o){t.player.fullscreen&&t.config.rotateFullscreen&&(window.orientation===90||window.orientation===-90?t.player.setRotateDeg(0):t.player.setRotateDeg(90))}),t}return x(r,[{key:"afterCreate",value:function(){var e=this;S(b(r.prototype),"afterCreate",this).call(this);var i=this.config,n=this.playerConfig;if(!i.disable){i.target&&(this.playerConfig.fullscreenTarget=this.config.target);var o=c.getFullScreenEl();n.fullscreenTarget===o&&this.player.getFullscreen().catch(function(u){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(l){var f=e.player.fullscreen;e.emitUserAction(l,"switch_fullscreen",{prop:"fullscreen",from:f,to:!f})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(ne,function(u){var l=e.find(".xg-tips");l&&e.changeLangTextKey(l,u?e.i18nKeys.EXITFULLSCREEN_TIPS:e.i18nKeys.FULLSCREEN_TIPS),e.animate(u)}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:Kn,options:{config:{onClick:function(l){e.handleFullscreen(l)}}}})),M.device==="mobile"&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:Xn,class:"xg-get-fullscreen"},exitFullscreen:{icon:$n,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",M.device==="mobile"?"touchend":"click",this.handleFullscreen),M.device==="mobile"&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.fullscreen),this.appendChild(".xgplayer-icon",e.exitFullscreen)}},{key:"toggleFullScreen",value:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=this.player,n=this.config,o=n.useCssFullscreen===!0||typeof n.useCssFullscreen=="function"&&n.useCssFullscreen();o?(i.fullscreen?i.exitCssFullscreen():i.getCssFullscreen(),this.animate(i.fullscreen)):n.rotateFullscreen?(i.fullscreen?i.exitRotateFullscreen():i.getRotateFullscreen(),this.animate(i.fullscreen)):n.switchCallback&&typeof n.switchCallback=="function"?n.switchCallback(i.fullscreen):i.fullscreen?(i.exitFullscreen(),n.useScreenOrientation&&this.unlockScreen()):(i.getFullscreen().catch(function(u){}),n.useScreenOrientation&&i.aspectRatio>1&&this.lockScreen(n.lockOrientationType))}},{key:"animate",value:function(e){e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(e?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"render",value:function(){if(!this.config.disable){var e="FULLSCREEN_TIPS";return`<xg-icon class="xgplayer-fullscreen">
    <div class="xgplayer-icon">
    </div>
    `.concat(Ce(this,e,this.playerConfig.isHideTips),`
    </xg-icon>`)}}},{key:"lockScreen",value:function(e){try{screen.orientation.lock(e).catch(function(i){})}catch{}}},{key:"unlockScreen",value:function(){try{screen.orientation.unlock().catch(function(e){})}catch{}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,useScreenOrientation:!1,lockOrientationType:"landscape",switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),r}(Ee),Zn=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),e.isActiving=!1,e}return x(r,[{key:"duration",get:function(){var e=this.player,i=e.offsetDuration,n=e.duration;return this.playerConfig.customDuration||i||n}},{key:"currentTime",get:function(){var e=this.player,i=e.offsetCurrentTime,n=e.currentTime;return i>=0?i:n}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var e=this,i=this.player.controls.config.mode;this.mode=i==="flex"?"flex":"normal",!this.config.disable&&(this.mode==="flex"&&(this.createCenterTime(),this.root.style.display="none"),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on([Ne,re,se],function(n){n.eventName==="durationchange"&&(e.isActiving=!1),e.onTimeUpdate()}),this.on(we,function(){e.onTimeUpdate(!0)}),this.on(Fe,function(){e.onReset()}))}},{key:"show",value:function(e){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="block"),this.centerDurDom&&(this.centerDurDom.style.display="block");return}this.root.style.display="block"}},{key:"hide",value:function(){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="none"),this.centerDurDom&&(this.centerDurDom.style.display="none");return}this.root.style.display="none"}},{key:"onTimeUpdate",value:function(e){var i=this.player,n=this.config,o=this.duration;if(!(n.disable||this.isActiving||!i.hasStart)){var u=this.currentTime+this.timeOffset;u=c.adjustTimeByDuration(u,o,e),this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(c.format(u)),o!==1/0&&o>0&&(this.centerDurDom.innerHTML=c.format(o))):(this.timeDom.innerHTML=this.minWidthTime(c.format(u)),o!==1/0&&o>0&&(this.durationDom.innerHTML=c.format(o)))}}},{key:"onReset",value:function(){this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(c.format(0)),this.centerDurDom.innerHTML=c.format(0)):(this.timeDom.innerHTML=this.minWidthTime(c.format(0)),this.durationDom.innerHTML=c.format(0))}},{key:"createCenterTime",value:function(){var e=this.player;if(!(!e.controls||!e.controls.center)){var i=e.controls.center;this.centerCurDom=c.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-left"),this.centerDurDom=c.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-right"),i.children.length>0?i.insertBefore(this.centerCurDom,i.children[0]):i.appendChild(this.centerCurDom),i.appendChild(this.centerDurDom)}}},{key:"afterPlayerInit",value:function(){var e=this.config;if(this.duration===1/0||this.playerConfig.isLive?(c.hide(this.durationDom),c.hide(this.timeDom),c.hide(this.find(".time-separator")),c.show(this.find(".time-live-tag"))):c.hide(this.find(".time-live-tag")),e.hide){this.hide();return}this.show()}},{key:"changeLiveState",value:function(e){e?(c.hide(this.durationDom),c.hide(this.timeDom),c.hide(this.find(".time-separator")),c.show(this.find(".time-live-tag"))):(c.hide(this.find(".time-live-tag")),c.show(this.find(".time-separator")),c.show(this.durationDom),c.show(this.timeDom))}},{key:"updateTime",value:function(e){if(this.isActiving=!0,!(!e&&e!==0||e>this.duration)){if(this.mode==="flex"){this.centerCurDom.innerHTML=this.minWidthTime(c.format(e));return}this.timeDom.innerHTML=this.minWidthTime(c.format(e))}}},{key:"minWidthTime",value:function(e){return e.split(":").map(function(i){return'<span class="time-min-width">'.concat(i,"</span>")}).join(":")}},{key:"resetActive",value:function(){var e=this,i=this.player,n=function(){e.isActiving=!1};this.off(re,n),i.isSeeking&&i.media.seeking?this.once(re,n):this.isActiving=!1}},{key:"destroy",value:function(){var e=this.player.controls.center;this.centerCurDom&&e.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&e.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-time">
    <span class="time-current">00:00</span>
    <span class="time-separator">/</span>
    <span class="time-duration">00:00</span>
    <span class="time-live-tag">`.concat(this.i18n.LIVE_TIP,`</span>
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_LEFT,index:2,disable:!1}}}]),r}(B);function Qn(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function Jn(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function er(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`,"image/svg+xml").firstChild}var tr=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"onBarMousedown",function(o){var u=_(t),l=u.player,f=t.find(".xgplayer-bar");c.event(o);var h=f.getBoundingClientRect(),d=c.getEventPos(o,l.zoom),v=h.height-(d.clientY-h.top);if(d.h=v,d.barH=h.height,t.pos=d,!(v<-2))return t.updateVolumePos(v,o),document.addEventListener("mouseup",t.onBarMouseUp),t._d.isStart=!0,!1}),k(_(t),"onBarMouseMove",function(o){var u=_(t),l=u._d;if(l.isStart){var f=_(t),h=f.pos,d=f.player;o.preventDefault(),o.stopPropagation(),c.event(o);var v=c.getEventPos(o,d.zoom);l.isMoving=!0;var g=h.h-v.clientY+h.clientY;g>h.barH||t.updateVolumePos(g,o)}}),k(_(t),"onBarMouseUp",function(o){c.event(o),document.removeEventListener("mouseup",t.onBarMouseUp);var u=_(t),l=u._d;l.isStart=!1,l.isMoving=!1}),k(_(t),"onMouseenter",function(o){t._d.isActive=!0,t.focus(),t.emit("icon_mouseenter",{pluginName:t.pluginName})}),k(_(t),"onMouseleave",function(o){t._d.isActive=!1,t.unFocus(100,!1,o),t.emit("icon_mouseleave",{pluginName:t.pluginName})}),k(_(t),"onVolumeChange",function(o){if(t.player){var u=t.player,l=u.muted,f=u.volume;t._d.isMoving||(t.find(".xgplayer-drag").style.height=l||f===0?"4px":"".concat(f*100,"%"),t.config.showValueLabel&&t.updateVolumeValue()),t.animate(l,f)}}),t}return x(r,[{key:"registerIcons",value:function(){return{volumeSmall:{icon:Jn,class:"xg-volume-small"},volumeLarge:{icon:Qn,class:"xg-volume"},volumeMuted:{icon:er,class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var e=this;if(this._timerId=null,this._d={isStart:!1,isMoving:!1,isActive:!1},!this.config.disable){this.initIcons();var i=this.playerConfig,n=i.commonStyle,o=i.volume;n.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=n.volumeColor),this.changeMutedHandler=this.hook("mutedChange",function(u){e.changeMuted(u)},{pre:function(l){l.preventDefault(),l.stopPropagation()}}),this._onMouseenterHandler=this.hook("mouseenter",this.onMouseenter),this._onMouseleaveHandler=this.hook("mouseleave",this.onMouseleave),M.device!=="mobile"&&this.playerConfig.isMobileSimulateMode!=="mobile"&&(this.bind("mouseenter",this._onMouseenterHandler),this.bind(["blur","mouseleave"],this._onMouseleaveHandler),this.bind(".xgplayer-slider","mousedown",this.onBarMousedown),this.bind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.bind(".xgplayer-slider","mouseup",this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.changeMutedHandler),this.on(Bi,this.onVolumeChange),this.once(Pe,this.onVolumeChange),c.typeOf(o)!=="Number"&&(this.player.volume=this.config.default),this.onVolumeChange()}}},{key:"updateVolumePos",value:function(e,i){var n=this.player,o=this.find(".xgplayer-drag"),u=this.find(".xgplayer-bar");if(!(!u||!o)){var l=parseInt(e/u.getBoundingClientRect().height*1e3,10);o.style.height="".concat(e,"px");var f=Math.max(Math.min(l/1e3,1),0),h={volume:{from:n.volume,to:f}};n.muted&&(h.muted={from:!0,to:!1}),this.emitUserAction(i,"change_volume",{muted:n.muted,volume:n.volume,props:h}),n.volume=Math.max(Math.min(l/1e3,1),0),n.muted&&(n.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var e=this.player,i=e.volume,n=e.muted,o=this.find(".xgplayer-value-label"),u=Math.max(Math.min(i,1),0);o.innerText=n?0:Math.round(u*100)}},{key:"focus",value:function(){var e=this.player;e.focus({autoHide:!1}),this._timerId&&(c.clearTimeout(this,this._timerId),this._timerId=null),c.addClass(this.root,"slide-show")}},{key:"unFocus",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2?arguments[2]:void 0,u=this._d,l=this.player;u.isActive||(this._timerId&&(c.clearTimeout(this,this._timerId),this._timerId=null),this._timerId=c.setTimeout(this,function(){u.isActive||(n?l.blur():l.focus(),c.removeClass(e.root,"slide-show"),u.isStart&&e.onBarMouseUp(o)),e._timerId=null},i))}},{key:"changeMuted",value:function(e){e&&e.stopPropagation();var i=this.player,n=this._d;n.isStart&&this.onBarMouseUp(e),this.emitUserAction(e,"change_muted",{muted:i.muted,volume:i.volume,props:{muted:{from:i.muted,to:!i.muted}}}),i.volume>0&&(i.muted=!i.muted),i.volume<.01&&(i.volume=this.config.miniVolume)}},{key:"animate",value:function(e,i){e||i===0?this.setAttr("data-state","mute"):i<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.volumeSmall),this.appendChild(".xgplayer-icon",e.volumeLarge),this.appendChild(".xgplayer-icon",e.volumeMuted)}},{key:"destroy",value:function(){this._timerId&&(c.clearTimeout(this,this._timerId),this._timerId=null),this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider","mousedown",this.onBarMousedown),this.unbind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.unbind(".xgplayer-slider","mouseup",this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon",M.device==="mobile"?"touchend":"click",this.changeMutedHandler)}},{key:"render",value:function(){if(!this.config.disable){var e=this.config.default||this.player.volume,i=this.config.showValueLabel;return`
    <xg-icon class="xgplayer-volume" data-state="normal">
      <div class="xgplayer-icon">
      </div>
      <xg-slider class="xgplayer-slider">
        `.concat(i?'<div class="xgplayer-value-label">'.concat(e*100,"</div>"):"",`
        <div class="xgplayer-bar">
          <xg-drag class="xgplayer-drag" style="height: `).concat(e*100,`%"></xg-drag>
        </div>
      </xg-slider>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}]),r}(B);function ir(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`,"image/svg+xml").firstChild}var nr=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),e.rotateDeg=e.config.rotateDeg||0,e}return x(r,[{key:"afterCreate",value:function(){var e=this;if(!this.config.disable){S(b(r.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.rotate),this.onBtnClick=this.onBtnClick.bind(this),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(_e,function(){e.rotateDeg&&e.config.innerRotate&&c.setTimeout(e,function(){e.updateRotateDeg(e.rotateDeg,e.config.innerRotate)},100)});var i=this.player.root;this.rootWidth=i.style.width||i.offsetWidth||i.clientWidth,this.rootHeight=i.style.height||i.offsetHeight||i.clientHeight,this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate)}}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"onBtnClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"rotate"),this.rotate(this.config.clockwise,this.config.innerRotate,1)}},{key:"updateRotateDeg",value:function(e,i){if(e||(e=0),i){this.player.videoRotateDeg=e;return}var n=this.player,o=this.rootWidth,u=this.rootHeight,l=n.root,f=n.innerContainer,h=n.media,d=l.offsetWidth,v=f&&i?f.offsetHeight:l.offsetHeight,g=o,m=u,p=0,T=0;(e===.75||e===.25)&&(g="".concat(v,"px"),m="".concat(d,"px"),p=-(v-d)/2,T=-(d-v)/2);var E="translate(".concat(p,"px,").concat(T,"px) rotate(").concat(e,"turn)"),C={transformOrigin:"center center",transform:E,webKitTransform:E,height:m,width:g},N=i?h:l,P=i?n.getPlugin("poster"):null;Object.keys(C).map(function(F){N.style[F]=C[F],P&&P.root&&(P.root.style[F]=C[F])})}},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=this.player;this.rotateDeg||(this.rotateDeg=0);var u=e?1:-1;this.rotateDeg=(this.rotateDeg+1+u*.25*n)%1,this.updateRotateDeg(this.rotateDeg,i),o.emit(Xi,this.rotateDeg*360)}},{key:"registerIcons",value:function(){return{rotate:ir}}},{key:"render",value:function(){if(!this.config.disable)return`
    <xg-icon class="xgplayer-rotate">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ce(this,"ROTATE_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}]),r}(Ee);function rr(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}function sr(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M9.4998 7.7C9.77595 7.7 9.9998 7.47614 9.9998 7.2V6.5C9.9998 6.22386 9.77595 6 9.4998 6H5.5402L5.52754 6.00016H5.5C5.22386 6.00016 5 6.22401 5 6.50016V10.4598C5 10.7359 5.22386 10.9598 5.5 10.9598H6.2C6.47614 10.9598 6.7 10.7359 6.7 10.4598V8.83005L8.76983 10.9386C8.96327 11.1357 9.27984 11.1386 9.47691 10.9451L9.97645 10.4548C10.1735 10.2613 10.1764 9.94476 9.983 9.7477L7.97289 7.7H9.4998Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}var ve={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},ar=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"switchPIP",function(o){if(!t.isPIPAvailable())return!1;o.stopPropagation&&o.stopPropagation(),t.isPip?(t.exitPIP(),t.emitUserAction(o,"change_pip",{props:"pip",from:!0,to:!1}),t.setAttr("data-state","normal")):t.player.media.readyState===4&&(t.requestPIP(),t.emitUserAction(o,"change_pip",{props:"pip",from:!1,to:!0}),t.setAttr("data-state","pip"))}),t}return x(r,[{key:"beforeCreate",value:function(e){typeof e.player.config.pip=="boolean"&&(e.config.showIcon=e.player.config.pip)}},{key:"afterCreate",value:function(){var e=this;this.isPIPAvailable()&&(S(b(r.prototype),"afterCreate",this).call(this),this.pMode=ve.INLINE,this.initPipEvents(),this.config.showIcon&&this.initIcons(),this.once(Bt,function(){e.config.showIcon&&(c.removeClass(e.find(".xgplayer-icon"),"xg-icon-disable"),e.bind("click",e.switchPIP))}))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:rr,class:"xg-get-pip"},pipIconExit:{icon:sr,class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.pipIcon),this.appendChild(".xgplayer-icon",e.pipIconExit)}},{key:"initPipEvents",value:function(){var e=this,i=this.player;this.leavePIPCallback=function(){var n=i.paused;c.setTimeout(e,function(){!n&&i.mediaPlay()},0),!n&&i.mediaPlay(),e.setAttr("data-state","normal"),e.pipWindow=null,i.emit(ft,!1)},this.enterPIPCallback=function(n){i.emit(ft,!0),n!=null&&n.pictureInPictureWindow&&(e.pipWindow=n.pictureInPictureWindow),e.setAttr("data-state","pip")},this.onWebkitpresentationmodechanged=function(n){var o=i.media.webkitPresentationMode;e.pMode===ve.FULLSCREEN&&o!==ve.FULLSCREEN&&i.onFullscreenChange(null,!1),e.pMode=o,o===ve.PIP?e.enterPIPCallback(n):o===ve.INLINE&&e.leavePIPCallback(n)},i.media&&(i.media.addEventListener("enterpictureinpicture",this.enterPIPCallback),i.media.addEventListener("leavepictureinpicture",this.leavePIPCallback),r.checkWebkitSetPresentationMode(i.media)&&i.media.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"copyStyleIntoPiPWindow",value:function(e){var i=J(document.styleSheets).map(function(o){try{return J(o.cssRules).map(function(l){return l.cssText}).join("")}catch{var u=document.createElement("link");u.rel="stylesheet",u.type=o.type,u.media=o.media,u.href=o.href,e.document.head.appendChild(u)}return""}).filter(Boolean).join(`
`),n=document.createElement("style");n.textContent=i,e.document.head.appendChild(n)}},{key:"requestPIP",value:function(){var e=this,i=this.player,n=this.playerConfig,o=this.config;if(!(!this.isPIPAvailable()||this.isPip))try{var u=n.poster;if(u&&(i.media.poster=c.typeOf(u)==="String"?u:u.poster),o.preferDocument&&this.isDocPIPAvailable()){var l={};if(o.width&&o.height)l.width=o.width,l.height=o.height;else{var f=i.root.getBoundingClientRect();l.width=f.width,l.height=f.height}documentPictureInPicture.requestWindow(l).then(function(h){var d=o.docPiPNode,v=o.docPiPStyle;e.enterPIPCallback();var g=d||i.root,m=g.parentElement,p=g.previousSibling,T=g.nextSibling;e.copyStyleIntoPiPWindow(h);var E=document.createElement("style");if(E.append("body{padding:0; margin:0;}"),v){var C="";typeof v=="string"?C=v:typeof v=="function"&&(C=v.call(o)),C&&E.append(C)}else g===i.root&&E.append(`
              .xgplayer{width: 100%!important; height: 100%!important;}
            `);h.document.head.append(E),h.document.body.append(g),h.addEventListener("pagehide",function(N){m&&(T?m.insertBefore(g,T):p?m.insertBefore(g,p.nextSibling):m.appendChild(g)),e.leavePIPCallback()},{once:!0})})}else r.checkWebkitSetPresentationMode(i.media)?i.media.webkitSetPresentationMode("picture-in-picture"):i.media.requestPictureInPicture();return!0}catch(h){return console.error("requestPiP",h),!1}}},{key:"exitPIP",value:function(){var e=this.player;try{if(this.isPIPAvailable()&&this.isPip){var i;this.isDocPIPAvailable()&&(i=documentPictureInPicture)!==null&&i!==void 0&&i.window?documentPictureInPicture.window.close():r.checkWebkitSetPresentationMode(e.media)?e.media.webkitSetPresentationMode("inline"):document.exitPictureInPicture()}return!0}catch(n){return console.error("exitPIP",n),!1}}},{key:"isPip",get:function(){var e,i=this.player;return!!(this.isDocPIPAvailable()&&(e=documentPictureInPicture)!==null&&e!==void 0&&e.window)||document.pictureInPictureElement&&document.pictureInPictureElement===i.media||i.media.webkitPresentationMode===ve.PIP}},{key:"isPIPAvailable",value:function(){var e=this.player.media,i=c.typeOf(document.pictureInPictureEnabled)==="Boolean"?document.pictureInPictureEnabled:!0;return i&&(c.typeOf(e.disablePictureInPicture)==="Boolean"&&!e.disablePictureInPicture||e.webkitSupportsPresentationMode&&c.typeOf(e.webkitSetPresentationMode)==="Function")||this.isDocPIPAvailable()}},{key:"isDocPIPAvailable",value:function(){return"documentPictureInPicture"in window&&/^(https|file)/.test(location.protocol)}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this);var e=this.player;e.media.removeEventListener("enterpictureinpicture",this.enterPIPCallback),e.media.removeEventListener("leavepictureinpicture",this.leavePIPCallback),r.checkWebkitSetPresentationMode(e.media)&&e.media.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.exitPIP(),this.unbind("click",this.btnClick)}},{key:"render",value:function(){if(!(!this.config.showIcon||!this.isPIPAvailable()))return`<xg-icon class="xgplayer-pip">
      <div class="xgplayer-icon xg-icon-disable">
      </div>
      `.concat(Ce(this,"PIP",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:6,showIcon:!1,preferDocument:!1,width:void 0,height:void 0,docPiPNode:void 0,docPiPStyle:void 0}}},{key:"checkWebkitSetPresentationMode",value:function(e){return typeof e.webkitSetPresentationMode=="function"}}]),r}(Ee);function or(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`,"image/svg+xml").firstChild}var ur=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),k(_(e),"playNext",function(i){var n=_(e),o=n.player;i.preventDefault(),i.stopPropagation(),e.idx+1<e.config.urlList.length?(e.idx++,e.nextHandler(e.config.urlList[e.idx],e.idx),o.emit(qe,e.idx+1)):(e.nextHandler(),o.emit(qe))}),e.idx=-1,e}return x(r,[{key:"afterCreate",value:function(){!this.config.urlList||this.config.urlList.length===0||(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:or}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e=M.device==="mobile"?"touchend":"click";this.bind(e,this.playNext),this.show()}},{key:"changeSrc",value:function(e){var i=this.player;e&&(i.pause(),i.currentTime=0,i.switchURL?i.switchURL(e):i.src=e,i.config.url=e,i.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(!(!this.config.urlList||this.config.urlList.length===0))return`
     <xg-icon class="xgplayer-playnext">
      <div class="xgplayer-icon">
      </div>
      `.concat(Ce(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),`
     </xg-icon>
    `)}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),r}(B),Kt={exports:{}};(function(a,s){(function(r,t){a.exports=t()})(ti,function(){return function r(t,e,i){var n=window,o="application/octet-stream",u=i||o,l=t,f=!e&&!i&&l,h=document.createElement("a"),d=function(I){return String(I)},v=n.Blob||n.MozBlob||n.WebKitBlob||d,g=e||"download",m,p;if(v=v.call?v.bind(n):Blob,String(this)==="true"&&(l=[l,u],u=l[0],l=l[1]),f&&f.length<2048&&(g=f.split("/").pop().split("?")[0],h.href=f,h.href.indexOf(f)!==-1)){var T=new XMLHttpRequest;return T.open("GET",f,!0),T.responseType="blob",T.onload=function(I){r(I.target.response,g,o)},setTimeout(function(){T.send()},0),T}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l))if(l.length>1024*1024*1.999&&v!==d)l=P(l),u=l.type||o;else return navigator.msSaveBlob?navigator.msSaveBlob(P(l),g):F(l);else if(/([\x80-\xff])/.test(l)){var E=0,C=new Uint8Array(l.length),N=C.length;for(E;E<N;++E)C[E]=l.charCodeAt(E);l=new v([C],{type:u})}m=l instanceof v?l:new v([l],{type:u});function P(I){var V=I.split(/[:;,]/),U=V[1],O=V[2]=="base64"?atob:decodeURIComponent,K=O(V.pop()),$=K.length,q=0,ae=new Uint8Array($);for(q;q<$;++q)ae[q]=K.charCodeAt(q);return new v([ae],{type:U})}function F(I,V){if("download"in h)return h.href=I,h.setAttribute("download",g),h.className="download-js-link",h.innerHTML="downloading...",h.style.display="none",document.body.appendChild(h),setTimeout(function(){h.click(),document.body.removeChild(h),V===!0&&setTimeout(function(){n.URL.revokeObjectURL(h.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(I)&&(I="data:"+I.replace(/^data:([\w\/\-\+]+)/,o)),window.open(I)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=I),!0;var U=document.createElement("iframe");document.body.appendChild(U),!V&&/^data:/.test(I)&&(I="data:"+I.replace(/^data:([\w\/\-\+]+)/,o)),U.src=I,setTimeout(function(){document.body.removeChild(U)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(m,g);if(n.URL)F(n.URL.createObjectURL(m),!0);else{if(typeof m=="string"||m.constructor===d)try{return F("data:"+u+";base64,"+n.btoa(m))}catch{return F("data:"+u+","+encodeURIComponent(m))}p=new FileReader,p.onload=function(I){F(this.result)},p.readAsDataURL(m)}return!0}})})(Kt);var lr=Kt.exports;const cr=Qe(lr);function fr(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`,"image/svg+xml").firstChild}var hr=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),k(_(e),"download",function(i){if(!e.isLock){e.emitUserAction(i,"download");var n=e.playerConfig.url,o="";c.typeOf(n)==="String"?o=n:c.typeOf(n)==="Array"&&n.length>0&&(o=n[0].src);var u=e.getAbsoluteURL(o);cr(u),e.isLock=!0,e.timer=window.setTimeout(function(){e.isLock=!1,window.clearTimeout(e.timer),e.timer=null},300)}}),e.timer=null,e.isLock=!1,e}return x(r,[{key:"afterCreate",value:function(){S(b(r.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.appendChild(".xgplayer-icon",this.icons.download),this._handler=this.hook("click",this.download,{pre:function(i){i.preventDefault(),i.stopPropagation()}}),this.bind(["click","touchend"],this._handler))}},{key:"registerIcons",value:function(){return{download:fr}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var i=document.createElement("div");i.innerHTML='<a href="'.concat(e,'">x</a>'),e=i.firstChild.href}return e}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-download">
   <div class="xgplayer-icon">
   </div>
   `.concat(Ce(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:3,disable:!0}}}]),r}(Ee),dr=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"beforeCreate",value:function(e){typeof e.player.config.screenShot=="boolean"&&(e.config.disable=!e.player.config.screenShot)}},{key:"afterCreate",value:function(){S(b(r.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var e=this.config;this.initSize=function(i){e.fitVideo&&(e.width=i.vWidth,e.height=i.vHeight)},this.once(_e,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(e,i){var n=document.createElement("a");n.href=e,n.download=i;var o;try{typeof MouseEvent<"u"?o=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}):(o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null))}catch(u){console.error("MouseEvent unsupported",u)}o&&n.dispatchEvent(o)}},{key:"createCanvas",value:function(e,i){var n=document.createElement("canvas"),o=n.getContext("2d");this.canvasCtx=o,this.canvas=n,n.width=e||this.config.width,n.height=i||this.config.height,o.imageSmoothingEnabled=!0,o.imageSmoothingEnabled&&(o.imageSmoothingQuality="high")}},{key:"onClickBtn",value:function(e){var i=this;e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"shot");var n=this.config;this.shot(n.width,n.height).then(function(o){i.emit($i,o),n.saveImg&&i.saveScreenShot(o,n.name+n.format)})}},{key:"shot",value:function(e,i){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{quality:.92,type:"image/png"},u=this.config,l=this.player,f=o.quality||u.quality,h=o.type||u.type;return new Promise(function(d,v){var g=null,m;if(l.media.canvas)g=l.media.canvas;else{n.canvas?(n.canvas.width=e||u.width,n.canvas.height=i||u.height):n.createCanvas(e,i),g=n.canvas,m=n.canvasCtx;var p=l.media.videoWidth/l.media.videoHeight,T=g.width/g.height,E=0,C=0,N=l.media.videoWidth,P=l.media.videoHeight,F,I,V,U;p>T?(V=g.width,U=g.width/p,F=0,I=Math.round((g.height-U)/2)):p===T?(V=g.width,U=g.height,F=0,I=0):p<T&&(V=g.height*p,U=g.height,F=Math.round((g.width-V)/2),I=0),m.drawImage(l.media,E,C,N,P,F,I,V,U)}var O=g.toDataURL(h,f).replace(h,"image/octet-stream");O=O.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),d(O)})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(_e,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var e=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",i="SCREENSHOT";return`
      <xg-icon class="xgplayer-shot">
      <div class="`.concat(e,`">
      `).concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[i],'">').concat(this.i18n[i],"</span>"),`
      </div>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,saveImg:!0,fitVideo:!0,disable:!1,name:"screenshot"}}}]),r}(Ee),gr=function(){function a(s){w(this,a),this.config=s.config,this.parent=s.root,this.root=c.createDom("ul","",{},"xg-options-list xg-list-slide-scroll ".concat(this.config.className)),s.root.appendChild(this.root);var r=this.config.maxHeight;r&&this.setStyle({maxHeight:r}),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var t=this.config.domEventType==="touch"?"touchend":"click";this._delegates=B.delegate.call(this,this.root,"li",t,this.onItemClick)}return x(a,[{key:"renderItemList",value:function(r){var t=this,e=this.config,i=this.root;r?e.data=r:r=e.data,e.style&&Object.keys(e.style).map(function(n){i.style[n]=e[n]}),r.length>0&&(this.attrKeys=Object.keys(r[0])),this.root.innerHTML="",r.map(function(n,o){var u=n.selected?"option-item selected":"option-item";n["data-index"]=o,t.root.appendChild(c.createDom("li","<span>".concat(n.showText,"</span>"),n,u))})}},{key:"onItemClick",value:function(r){r.delegateTarget||(r.delegateTarget=r.target);var t=r.delegateTarget;if(t&&c.hasClass(t,"selected"))return!1;var e=typeof this.config.onItemClick=="function"?this.config.onItemClick:null,i=this.root.querySelector(".selected");c.addClass(t,"selected"),i&&c.removeClass(i,"selected"),e(r,{from:i?this.getAttrObj(i,this.attrKeys):null,to:this.getAttrObj(t,this.attrKeys)})}},{key:"getAttrObj",value:function(r,t){if(!r||!t)return{};var e={};t.map(function(n){e[n]=r.getAttribute(n)});var i=r.getAttribute("data-index");return i&&(e.index=Number(i)),e}},{key:"show",value:function(){c.removeClass(this.root,"hide"),c.addClass(this.root,"active")}},{key:"hide",value:function(){c.removeClass(this.root,"active"),c.addClass(this.root,"hide")}},{key:"setStyle",value:function(r){var t=this;Object.keys(r).forEach(function(e){t.root.style[e]=r[e]})}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(r){r.destroy&&r.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}]),a}(),Z={SIDE:"side",MIDDLE:"middle",DEFAULT:"default"},pe={CLICK:"click",HOVER:"hover"};function vr(a,s){return a===Z.SIDE?s===H.CONTROLS_LEFT?"xg-side-list xg-left-side":"xg-side-list xg-right-side":""}var oe=M.device==="mobile",Re=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),k(_(e),"onEnter",function(i){i.stopPropagation(),e.emit("icon_mouseenter",{pluginName:e.pluginName}),e.switchActiveState(i)}),k(_(e),"switchActiveState",function(i){i.stopPropagation();var n=e.config.toggleMode;n===pe.CLICK?e.toggle(!e.isActive):e.toggle(!0)}),k(_(e),"onLeave",function(i){i.stopPropagation(),e.emit("icon_mouseleave",{pluginName:e.pluginName}),e.config.listType!==Z.SIDE&&e.isActive&&e.toggle(!1)}),k(_(e),"onListEnter",function(i){e.enterType=2}),k(_(e),"onListLeave",function(i){e.enterType=0,e.isActive&&e.toggle(!1)}),e.isIcons=!1,e.isActive=!1,e.curValue=null,e.curIndex=0,e}return x(r,[{key:"updateLang",value:function(e){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var e=this,i=this.config;this.initIcons(),oe=oe||this.domEventType==="touch",oe&&M.device==="mobile"&&i.listType===Z.DEFAULT&&(i.listType=Z.SIDE),i.hidePortrait&&c.addClass(this.root,"portrait"),this.on([_e,ne],function(){e._resizeList()}),this.once(ce,function(){i.list&&i.list.length>0&&(e.renderItemList(i.list),e.show())}),oe&&this.on(Ft,function(){e.isActive&&(e.optionsList&&e.optionsList.hide(),e.isActive=!1)}),oe?(i.toggleMode=pe.CLICK,this.activeEvent="touchend"):this.activeEvent=i.toggleMode===pe.CLICK?"click":"mouseenter",i.toggleMode===pe.CLICK?this.bind(this.activeEvent,this.switchActiveState):(this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave)),this.isIcons&&this.bind("click",this.onIconClick)}},{key:"initIcons",value:function(){var e=this,i=this.icons,n=Object.keys(i),o=!1;n.length>0&&(n.forEach(function(u){e.appendChild(".xgplayer-icon",i[u]),!o&&(o=i[u])}),this.isIcons=o),!o&&(this.appendChild(".xgplayer-icon",c.createDom("span","",{},"icon-text")),c.addClass(this.find(".xgplayer-icon"),"btn-text"))}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||c.addClass(this.root,"show")}},{key:"hide",value:function(){c.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(e,i,n){if(e===void 0)return"";var o=this.config.list;!n&&(n=this.player.lang),i=!i||c.isUndefined(e[i])?"text":i,typeof e=="number"&&(e=o[e]);try{return Y(e[i])==="object"?e[i][n]||e[i].en:e[i]}catch(u){return console.warn(u),""}}},{key:"toggle",value:function(e){if(!(e===this.isActive||this.config.disable)){var i=this.player.controls,n=this.config.listType;e?(n===Z.SIDE?i.blur():i.focus(),this.optionsList&&this.optionsList.show()):(n===Z.SIDE?i.focus():i.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=e}}},{key:"onItemClick",value:function(e,i){e.stopPropagation();var n=this.config,o=n.listType,u=n.list;this.curIndex=i.to.index,this.curItem=u[this.curIndex],this.changeCurrentText();var l=this.config.isItemClickHide;(l||oe||o===Z.SIDE)&&this.toggle(!1)}},{key:"onIconClick",value:function(e){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,i=this.curIndex<e.length?this.curIndex:0,n=e[i];n&&(this.find(".icon-text").innerHTML=this.getTextByLang(n,"iconText"))}}},{key:"renderItemList",value:function(e,i){var n=this,o=this.config,u=this.optionsList,l=this.player;if(typeof i=="number"&&(this.curIndex=i,this.curItem=o.list[i]),u){u.renderItemList(e),this.changeCurrentText();return}var f={config:{data:e||[],className:vr(o.listType,o.position),onItemClick:function(m,p){n.onItemClick(m,p)},domEventType:oe?"touch":"mouse"},root:o.listType===Z.SIDE?l.innerContainer||l.root:this.root};if(this.config.isShowIcon){var h=this.player.root.getBoundingClientRect(),d=h.height,v=o.listType===Z.MIDDLE?d-50:d;v&&o.heightLimit&&(f.config.maxHeight="".concat(v,"px")),this.optionsList=new gr(f),this.changeCurrentText(),this.show()}this._resizeList()}},{key:"_resizeList",value:function(){if(this.config.heightLimit){var e=this.player.root.getBoundingClientRect(),i=e.height,n=this.config.listType===Z.MIDDLE?i-50:i;this.optionsList&&this.optionsList.setStyle({maxHeight:"".concat(n,"px")})}}},{key:"destroy",value:function(){var e=this.config;e.toggleMode===pe.CLICK?this.unbind(this.activeEvent,this.switchActiveState):(this.unbind(this.activeEvent,this.onEnter),this.unbind("mouseleave",this.onLeave)),this.isIcons&&this.unbind("click",this.onIconClick),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",`">
    <div class="xgplayer-icon">
    </div>
   </xg-icon>`)}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:H.CONTROLS_RIGHT,index:100,list:[],listType:"default",listStyle:{},hidePortrait:!0,isShowIcon:!1,isItemClickHide:!0,toggleMode:pe.HOVER,heightLimit:!0}}}]),r}(B),pr=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),e.curTime=0,e.isPaused=!0,e}return x(r,[{key:"beforeCreate",value:function(e){var i=e.config.list;Array.isArray(i)&&i.length>0&&(e.config.list=i.map(function(n){return!n.text&&n.name&&(n.text=n.name),n.text||(n.text=n.definition),n}))}},{key:"afterCreate",value:function(){var e=this;S(b(r.prototype),"afterCreate",this).call(this),this.on("resourceReady",function(i){e.changeDefinitionList(i)}),this.on(Gt,function(i){e.renderItemList(e.config.list,i.to)}),this.player.definitionList.length<2&&this.hide()}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||c.addClass(this.root,"show")}},{key:"initDefinition",value:function(){var e=this.config,i=e.list,n=e.defaultDefinition;if(i.length>0){var o=null;i.map(function(u){u.definition===n&&(o=u)}),o||(o=i[0]),this.changeDefinition(o)}}},{key:"renderItemList",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.list||[],n=arguments.length>1?arguments[1]:void 0,o=n&&n.definition?n.definition:this.config.defaultDefinition;n&&i.forEach(function(f){f.selected=!1});var u=0,l=i.map(function(f,h){var d=W(W({},f),{},{showText:e.getTextByLang(f)||f.definition,selected:!1});return(f.selected||f.definition&&f.definition==o)&&(d.selected=!0,u=h),d});S(b(r.prototype),"renderItemList",this).call(this,l,u)}},{key:"changeDefinitionList",value:function(e){Array.isArray(e)&&(this.config.list=e.map(function(i){return!i.text&&i.name&&(i.text=i.name),i.text||(i.text=i.definition),i}),this.renderItemList(),this.config.list.length<2?this.hide():this.show())}},{key:"changeDefinition",value:function(e,i){this.player.changeDefinition(e,i)}},{key:"onItemClick",value:function(e,i){var n=this.player.definitionList;S(b(r.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(e,"change_definition",{from:i.from,to:i.to});for(var o=0;o<n.length;o++)i.to&&n[o].definition===i.to.definition&&(i.to.url=n[o].url),i.from&&n[o].definition===i.from.definition&&(i.from.url=n[o].url);this.player.changeDefinition(i.to,i.from)}}],[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return W(W({},Re.defaultConfig),{},{position:H.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0})}}]),r}(Re),mr=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),e.curRate=1,e}return x(r,[{key:"beforeCreate",value:function(e){var i=e.player.config.playbackRate,n=i?Array.isArray(i)?i:e.config.list:[];Array.isArray(n)&&(e.config.list=n.map(function(o){return typeof o=="number"?o={rate:o,text:"".concat(o,"x")}:!o.text&&o.rate&&(o.text="".concat(o.rate,"x")),o}))}},{key:"afterCreate",value:function(){var e=this;S(b(r.prototype),"afterCreate",this).call(this),this.on(Ui,function(){e.curValue!==e.player.playbackRate&&e.renderItemList()}),this.renderItemList()}},{key:"show",value:function(e){!this.config.list||this.config.list.length===0||S(b(r.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(e,i){S(b(r.prototype),"onItemClick",this).call(this,e,i);var n=e.delegateTarget,o=Number(n.getAttribute("rate"));if(!o||o===this.curValue)return!1;var u={playbackRate:{from:this.player.playbackRate,to:o}};this.emitUserAction(e,"change_rate",{props:u}),this.curValue=o,this.player.playbackRate=o}},{key:"renderItemList",value:function(){var e=this,i=this.player.playbackRate||1;this.curValue=i;var n=-1,o=this.config.list.map(function(u,l){var f={rate:u.rate};return f.rate===i&&(f.selected=!0,n=l),f.showText=e.getTextByLang(u),f});S(b(r.prototype),"renderItemList",this).call(this,o,n)}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,i=this.curIndex<e.length?this.curIndex:0,n=e[i],o="";!n||this.curIndex<0?o="".concat(this.player.playbackRate,"x"):o=this.getTextByLang(n,"iconText"),this.find(".icon-text").innerHTML=o}}},{key:"destroy",value:function(){S(b(r.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return W(W({},Re.defaultConfig),{},{position:H.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1})}}]),r}(Re),yr=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"afterCreate",value:function(){var e=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(n){n.preventDefault(),n.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(De,function(i){e.onError(i)})}},{key:"errorRetry",value:function(e){this.emitUserAction(e,"error_retry",{}),this.player.retry()}},{key:"handleError",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=this.player,n=e.errorType,o=i.errorNote?this.i18n[i.errorNote]:"";if(!o)switch(n){case"decoder":o=this.i18n.MEDIA_ERR_DECODE;break;case"network":o=this.i18n.MEDIA_ERR_NETWORK;break;default:o=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=o,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return`<xg-error class="xgplayer-error">
      <div class="xgplayer-errornote">
       <span class="xgplayer-error-text"></span>
       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>
      </div>
    </xg-error>`}}],[{key:"pluginName",get:function(){return"error"}}]),r}(B),_r=function(a){R(r,a);var s=D(r);function r(){return w(this,r),s.apply(this,arguments)}return x(r,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(i){(e.config.onClick||e.customOnClick)&&(i.preventDefault(),i.stopPropagation(),e.customOnClick?e.customOnClick(i):e.config.onClick(i))}),this.player.showPrompt=function(){e.showPrompt.apply(e,arguments)},this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var i=this;Object.keys(e).map(function(n){i.root.style[n]=e[n]})}},{key:"showPrompt",value:function(e){var i=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(e){this.customOnClick=o;var u=this.config.interval;this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),c.addClass(this.root,"show"),n.mode==="arrow"&&c.addClass(this.root,"arrow"),typeof e=="string"?this.find(".xgplayer-prompt-detail").innerHTML=e:this.find(".xgplayer-prompt-detail").innerHTML="".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):""),n.style&&this.setStyle(n.style);var l=typeof n.autoHide=="boolean"?n.autoHide:this.config.autoHide;if(l){var f=n.interval||u;this.intervalId=setTimeout(function(){i.hide()},f)}}}},{key:"hide",value:function(){c.removeClass(this.root,"show"),c.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(y.CONTROLS_FOLLOW,`">
    <span class="xgplayer-prompt-detail"></span>
    </xg-prompt>`)}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),r}(B),Cr=function(a){R(r,a);var s=D(r);function r(t){var e;return w(this,r),e=s.call(this,t),e.ratio=1,e.interval=null,e._preloadMark={},e}return x(r,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail(),this.on([Ne],function(){var i=e.config,n=i.pic_num,o=i.interval;e.usable&&(e.interval=o>0?o:Math.round(e.player.duration*1e3/n)/1e3)})}},{key:"setConfig",value:function(e){var i=this;if(e){var n=Object.keys(e);n.length<1||(n.forEach(function(o){i.config[o]=e[o]}),this.usable&&this.initThumbnail())}}},{key:"usable",get:function(){var e=this.config,i=e.urls,n=e.pic_num;return i&&i.length>0&&n>0}},{key:"initThumbnail",value:function(){var e=this.config,i=e.width,n=e.height,o=e.pic_num,u=e.interval;this.ratio=i/n*100,this.interval=u||Math.round(this.player.duration/o),this._preloadMark={}}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var i=this;if(!this._preloadMark[e]){var n=this.config.urls,o=n.length,u=[];e>0&&u.push(e-1),u.push(e),e>0&&e<o-1&&u.push(e+1),u.map(function(l){!i._preloadMark[l]&&l>=0&&l<o&&(i._preloadMark[l]=1,c.preloadImg(n[l],function(){i._preloadMark[l]=2}))})}}},{key:"getPosition",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=this.config,u=o.pic_num,l=o.row,f=o.col,h=o.width,d=o.height;this.interval=Math.round(this.player.duration/u);var v=Math.ceil(e/this.interval);v=v>u?u:v;var g=v<l*f?0:Math.ceil(v/(l*f))-1,m=v-g*(f*l),p=m>0?Math.ceil(m/f)-1:0,T=m>0?m-p*f-1:0,E=0,C=0;if(i&&n){var N=i/n;N<h/d?(C=n,E=C*(h/d)):(E=i,C=E/(h/d))}else n?i||(C=n||d,E=C*(h/d)):(E=i||h,C=E/(h/d));var P=this.getUrlByIndex(g);return{urlIndex:g,rowIndex:p,colIndex:T,url:P,height:C,width:E,style:{backgroundImage:"url(".concat(P,")"),backgroundSize:"".concat(E*f,"px auto"),backgroundPosition:"-".concat(T*E,"px -").concat(p*C,"px"),width:"".concat(E,"px"),height:"".concat(C,"px")}}}},{key:"update",value:function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",l=this.config,f=l.pic_num,h=l.urls;if(!(f<=0||!h||h.length===0)){var d=this.getPosition(i,n,o);this.preload(d.urlIndex),Object.keys(d.style).map(function(v){e.style[v]=d.style[v]}),Object.keys(u).map(function(v){e.style[v]=u[v]})}}},{key:"changeConfig",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(e)}},{key:"createThumbnail",value:function(e,i){var n=c.createDom("xg-thumbnail","",{},"thumbnail ".concat(i));return e&&e.appendChild(n),n}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}]),r}(B);function ze(a){return a?"background:".concat(a,";"):""}var Er=function(a){R(r,a);var s=D(r);function r(){var t;w(this,r);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t=s.call.apply(s,[this].concat(i)),k(_(t),"onTimeupdate",function(){var o=t.player.ended,u=_(t),l=u.offsetDuration,f=t.currentTime;f=c.adjustTimeByDuration(f,l,o),t.update({played:f},l)}),t}return x(r,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"currentTime",get:function(){var e=this.player,i=e.offsetCurrentTime,n=e.currentTime;return i>=0?i:n}},{key:"afterCreate",value:function(){var e=this;this.root&&(this.on(se,this.onTimeupdate),this.on(Fe,function(){e.reset()}))}},{key:"reset",value:function(){this.update({played:0,cached:0},0)}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},i=arguments.length>1?arguments[1]:void 0;!i||!this.root||(e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/i*100,"%")),e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/i*100,"%")))}},{key:"render",value:function(){var e=this.playerConfig,i=e.commonStyle,n=e.miniprogress;if(n){var o=this.config,u=o.mode,l=o.height,f={cached:ze(i.cachedColor),played:ze(i.playedColor),progress:ze(i.progressColor),height:l>0&&l!==2?"height: ".concat(l,"px;"):""},h=u==="show"?"xg-mini-progress-show":"";return'<xg-mini-progress class="xg-mini-progress '.concat(h,'" style="').concat(f.progress," ").concat(f.height,`">
    <xg-mini-progress-cache class="xg-mini-progress-cache" style="`).concat(f.cached,`"></xg-mini-progress-cache>
    <xg-mini-progress-played class="xg-mini-progress-played" style="`).concat(f.played,`"></xg-mini-progress-played>
    </xg-mini-progress>`)}}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{mode:"auto",height:2}}}]),r}(B),kr={LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}},Tr=x(function a(){w(this,a);var s=[Bn,Vn,zn,qn,Zn,nr,ur,pr,mr,hr,dr,tr,ar],r=[Pn,An,On,Gn,Rn,yr,_r,Cr,Er];this.plugins=[xn].concat(s,r),this.ignores=[],this.i18n=[kr]});const br=["id"],Sr={__name:"index",props:{id:{type:String,default:"video0"},src:{type:String},poster:{type:String},isDetail:{type:Boolean}},setup(a,{expose:s}){ni(o=>({"6bcc69ff":t.value})),Se.defaultPreset=Tr;const r=a,t=Te("block"),e=Te();return It(()=>{e.value=new Se({id:r.id,lang:"zh",volume:r.isDetail?.4:0,muted:!r.isDetail,autoplay:r.isDetail?{mode:"flex"}:!1,controls:!!r.isDetail,url:r.src,poster:r.poster,fluid:!0,playsinline:!0,miniprogress:!0,fullscreen:{rotateFullscreen:!0,needBackIcon:!0},commonStyle:{progressColor:"#FFFFFF",playedColor:"#FF5200",sliderBtnStyle:{display:"none"}},start:{isShowPause:!!r.isDetail},ignores:[r.isDetail?"":"replay","play","volume","playbackrate"]}),r.isDetail||(t.value="none")}),s({play:()=>{e.value.play()},pause:()=>{e.value.pause()}}),(o,u)=>(ri(),si("div",{id:r.id,class:"video",ref:"myVideo"},null,8,br))}},Lr=ii(Sr,[["__scopeId","data-v-7e5c5f4a"]]);export{Ar as L,gi as T,Lr as V};
