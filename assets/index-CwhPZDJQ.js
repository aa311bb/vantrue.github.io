import{u as j}from"./use-expose-Oe1mBPbS.js";import{c as q,a as D,m,l as F,w as G}from"./index-CRmXhf89.js";import{d as J,r as p,c as K,E as L,S as O,x as Q,b as S}from"./index-De6GvLOu.js";const[U,I]=q("text-ellipsis"),X={rows:D(1),dots:m("..."),content:m(""),expandText:m(""),collapseText:m(""),position:m("end")};var Y=J({name:U,props:X,emits:["clickAction"],setup(t,{emit:V,slots:g}){const y=p(""),u=p(!1),T=p(!1),x=p();let h=!1;const w=K(()=>u.value?t.collapseText:t.expandText),E=n=>{if(!n)return 0;const e=n.match(/^\d*(\.\d*)?/);return e?Number(e[0]):0},z=()=>{if(!x.value||!x.value.isConnected)return;const n=window.getComputedStyle(x.value),e=document.createElement("div");return Array.prototype.slice.apply(n).forEach(f=>{e.style.setProperty(f,n.getPropertyValue(f))}),e.style.position="fixed",e.style.zIndex="-9999",e.style.top="-9999px",e.style.height="auto",e.style.minHeight="auto",e.style.maxHeight="auto",e.innerText=t.content,document.body.appendChild(e),e},C=()=>{const n=(l,k)=>{const{content:a,position:v,dots:r}=t,d=a.length,_=()=>{const o=(s,c)=>{if(c-s<=1)return v==="end"?a.slice(0,s)+r:r+a.slice(c,d);const i=Math.round((s+c)/2);return v==="end"?l.innerText=a.slice(0,i)+r+w.value:l.innerText=r+a.slice(i,d)+w.value,l.offsetHeight>k?v==="end"?o(s,i):o(i,c):v==="end"?o(i,c):o(s,i)};l.innerText=o(0,d)},N=(o,s)=>{if(o[1]-o[0]<=1&&s[1]-s[0]<=1)return a.slice(0,o[0])+r+a.slice(s[1],d);const c=Math.floor((o[0]+o[1])/2),i=Math.ceil((s[0]+s[1])/2);return l.innerText=t.content.slice(0,c)+t.dots+t.content.slice(i,d)+t.expandText,l.offsetHeight>=k?N([o[0],c],[i,s[1]]):N([c,o[1]],[s[0],i])},H=0+d>>1;return t.position==="middle"?l.innerText=N([0,H],[H,d]):_(),l.innerText},e=z();if(!e){h=!0;return}const{paddingBottom:M,paddingTop:f,lineHeight:W}=e.style,b=Math.ceil((Number(t.rows)+.5)*E(W)+E(f)+E(M));b<e.offsetHeight?(T.value=!0,y.value=n(e,b)):(T.value=!1,y.value=t.content),document.body.removeChild(e)},A=(n=!u.value)=>{u.value=n},B=n=>{A(),V("clickAction",n)},R=()=>{const n=g.action?g.action({expanded:u.value}):w.value;return S("span",{class:I("action"),onClick:B},[n])};return L(C),O(()=>{h&&(h=!1,C())}),Q([F,()=>[t.content,t.rows,t.position]],C),j({toggle:A}),()=>S("div",{ref:x,class:I()},[u.value?t.content:y.value,T.value?R():null])}});const ee=G(Y);export{ee as T};
